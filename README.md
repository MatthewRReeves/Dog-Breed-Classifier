
# Artificial Intelligence Nanodegree

## Convolutional Neural Networks

## Project: Write an Algorithm for a Dog Identification App 

---

In this notebook, some template code has already been provided for you, and you will need to implement additional functionality to successfully complete this project. You will not need to modify the included code beyond what is requested. Sections that begin with **'(IMPLEMENTATION)'** in the header indicate that the following block of code will require additional functionality which you must provide. Instructions will be provided for each section, and the specifics of the implementation are marked in the code block with a 'TODO' statement. Please be sure to read the instructions carefully! 

> **Note**: Once you have completed all of the code implementations, you need to finalize your work by exporting the iPython Notebook as an HTML document. Before exporting the notebook to html, all of the code cells need to have been run so that reviewers can see the final implementation and output. You can then export the notebook by using the menu above and navigating to  \n",
    "**File -> Download as -> HTML (.html)**. Include the finished document along with this notebook as your submission.

In addition to implementing code, there will be questions that you must answer which relate to the project and your implementation. Each section where you will answer a question is preceded by a **'Question X'** header. Carefully read each question and provide thorough answers in the following text boxes that begin with **'Answer:'**. Your project submission will be evaluated based on your answers to each of the questions and the implementation you provide.

>**Note:** Code and Markdown cells can be executed using the **Shift + Enter** keyboard shortcut.  Markdown cells can be edited by double-clicking the cell to enter edit mode.

The rubric contains _optional_ "Stand Out Suggestions" for enhancing the project beyond the minimum requirements. If you decide to pursue the "Stand Out Suggestions", you should include the code in this IPython notebook.



---
### Why We're Here 

In this notebook, you will make the first steps towards developing an algorithm that could be used as part of a mobile or web app.  At the end of this project, your code will accept any user-supplied image as input.  If a dog is detected in the image, it will provide an estimate of the dog's breed.  If a human is detected, it will provide an estimate of the dog breed that is most resembling.  The image below displays potential sample output of your finished project (... but we expect that each student's algorithm will behave differently!). 

![Sample Dog Output](images/sample_dog_output.png)

In this real-world setting, you will need to piece together a series of models to perform different tasks; for instance, the algorithm that detects humans in an image will be different from the CNN that infers dog breed.  There are many points of possible failure, and no perfect algorithm exists.  Your imperfect solution will nonetheless create a fun user experience!

### The Road Ahead

We break the notebook into separate steps.  Feel free to use the links below to navigate the notebook.

* [Step 0](#step0): Import Datasets
* [Step 1](#step1): Detect Humans
* [Step 2](#step2): Detect Dogs
* [Step 3](#step3): Create a CNN to Classify Dog Breeds (from Scratch)
* [Step 4](#step4): Use a CNN to Classify Dog Breeds (using Transfer Learning)
* [Step 5](#step5): Create a CNN to Classify Dog Breeds (using Transfer Learning)
* [Step 6](#step6): Write your Algorithm
* [Step 7](#step7): Test Your Algorithm

---
<a id='step0'></a>
## Step 0: Import Datasets

### Import Dog Dataset

In the code cell below, we import a dataset of dog images.  We populate a few variables through the use of the `load_files` function from the scikit-learn library:
- `train_files`, `valid_files`, `test_files` - numpy arrays containing file paths to images
- `train_targets`, `valid_targets`, `test_targets` - numpy arrays containing onehot-encoded classification labels 
- `dog_names` - list of string-valued dog breed names for translating labels


```python
from sklearn.datasets import load_files       
from keras.utils import np_utils
import numpy as np
from glob import glob

# define function to load train, test, and validation datasets
def load_dataset(path):
    data = load_files(path)
    dog_files = np.array(data['filenames'])
    dog_targets = np_utils.to_categorical(np.array(data['target']), 133)
    return dog_files, dog_targets

# load train, test, and validation datasets
train_files, train_targets = load_dataset('dogImages/train')
valid_files, valid_targets = load_dataset('dogImages/valid')
test_files, test_targets = load_dataset('dogImages/test')

# load list of dog names
dog_names = [item[20:-1] for item in sorted(glob("dogImages/train/*/"))]

# print statistics about the dataset
print('There are %d total dog categories.' % len(dog_names))
print('There are %s total dog images.\n' % len(np.hstack([train_files, valid_files, test_files])))
print('There are %d training dog images.' % len(train_files))
print('There are %d validation dog images.' % len(valid_files))
print('There are %d test dog images.'% len(test_files))
```

    Using TensorFlow backend.
    

    There are 133 total dog categories.
    There are 8351 total dog images.
    
    There are 6680 training dog images.
    There are 835 validation dog images.
    There are 836 test dog images.
    

### Import Human Dataset

In the code cell below, we import a dataset of human images, where the file paths are stored in the numpy array `human_files`.


```python
import random
random.seed(8675309)

# load filenames in shuffled human dataset
human_files = np.array(glob("lfw/*/*"))
random.shuffle(human_files)

# print statistics about the dataset
print('There are %d total human images.' % len(human_files))
```

    There are 13233 total human images.
    

---
<a id='step1'></a>
## Step 1: Detect Humans

We use OpenCV's implementation of [Haar feature-based cascade classifiers](http://docs.opencv.org/trunk/d7/d8b/tutorial_py_face_detection.html) to detect human faces in images.  OpenCV provides many pre-trained face detectors, stored as XML files on [github](https://github.com/opencv/opencv/tree/master/data/haarcascades).  We have downloaded one of these detectors and stored it in the `haarcascades` directory.

In the next code cell, we demonstrate how to use this detector to find human faces in a sample image.


```python
import cv2                
import matplotlib.pyplot as plt                        
%matplotlib inline                               

# extract pre-trained face detector
face_cascade = cv2.CascadeClassifier('haarcascades/haarcascade_frontalface_alt.xml')

# load color (BGR) image
img = cv2.imread(human_files[3])
# convert BGR image to grayscale
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

# find faces in image
faces = face_cascade.detectMultiScale(gray)

# print number of faces detected in the image
print('Number of faces detected:', len(faces))

# get bounding box for each detected face
for (x,y,w,h) in faces:
    # add bounding box to color image
    cv2.rectangle(img,(x,y),(x+w,y+h),(255,0,0),2)
    
# convert BGR image to RGB for plotting
cv_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

# display the image, along with bounding box
plt.imshow(cv_rgb)
plt.show()
```

    Number of faces detected: 1
    


![png](output_5_1.png)


Before using any of the face detectors, it is standard procedure to convert the images to grayscale.  The `detectMultiScale` function executes the classifier stored in `face_cascade` and takes the grayscale image as a parameter.  

In the above code, `faces` is a numpy array of detected faces, where each row corresponds to a detected face.  Each detected face is a 1D array with four entries that specifies the bounding box of the detected face.  The first two entries in the array (extracted in the above code as `x` and `y`) specify the horizontal and vertical positions of the top left corner of the bounding box.  The last two entries in the array (extracted here as `w` and `h`) specify the width and height of the box.

### Write a Human Face Detector

We can use this procedure to write a function that returns `True` if a human face is detected in an image and `False` otherwise.  This function, aptly named `face_detector`, takes a string-valued file path to an image as input and appears in the code block below.


```python
# returns "True" if face is detected in image stored at img_path
def face_detector(img_path):
    img = cv2.imread(img_path)
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    faces = face_cascade.detectMultiScale(gray)
    return len(faces) > 0
```

### (IMPLEMENTATION) Assess the Human Face Detector

__Question 1:__ Use the code cell below to test the performance of the `face_detector` function.  
- What percentage of the first 100 images in `human_files` have a detected human face?  
- What percentage of the first 100 images in `dog_files` have a detected human face? 

Ideally, we would like 100% of human images with a detected face and 0% of dog images with a detected face.  You will see that our algorithm falls short of this goal, but still gives acceptable performance.  We extract the file paths for the first 100 images from each of the datasets and store them in the numpy arrays `human_files_short` and `dog_files_short`.

__Answer:__ 


99 percent of human_files have a detected human face

11 percent of dog_files have a detected human face


```python
human_files_short = human_files[:100]
dog_files_short = train_files[:100]
# Do NOT modify the code above this line.
Count_humans = 0
for i in range(len(human_files_short)):
    if face_detector(human_files_short[i]) == True:
        Count_humans += 1
        
print("%i percent of human_files have a detected human face" %(Count_humans*100/len(human_files_short)))

Count_dogs = 0
for i in range(len(dog_files_short)):
    if face_detector(dog_files_short[i]) == True:
        Count_dogs += 1
        
print("%i percent of dog_files have a detected human face" %(Count_dogs*100/len(dog_files_short)))
        
## TODO: Test the performance of the face_detector algorithm 
## on the images in human_files_short and dog_files_short.
```

    99 percent of human_files have a detected human face
    11 percent of dog_files have a detected human face
    

__Question 2:__ This algorithmic choice necessitates that we communicate to the user that we accept human images only when they provide a clear view of a face (otherwise, we risk having unneccessarily frustrated users!). In your opinion, is this a reasonable expectation to pose on the user? If not, can you think of a way to detect humans in images that does not necessitate an image with a clearly presented face?

__Answer:__ Yes I think this is a reasonable expectation to pose on the user. If this was not restricted it would be much more challenging to detect humans. You could use a different program to detect parts of humans other than faces, however this may become more challenging as different photos could contain different portions of humans and they could be in various poses all making it less accurate to detect humans. Alternatively you could have the user input whether the picture was human or not.

We suggest the face detector from OpenCV as a potential way to detect human images in your algorithm, but you are free to explore other approaches, especially approaches that make use of deep learning :).  Please use the code cell below to design and test your own face detection algorithm.  If you decide to pursue this _optional_ task, report performance on each of the datasets.


```python
## (Optional) TODO: Report the performance of another  
## face detection algorithm on the LFW dataset
### Feel free to use as many code cells as needed.
```

---
<a id='step2'></a>
## Step 2: Detect Dogs

In this section, we use a pre-trained [ResNet-50](http://ethereon.github.io/netscope/#/gist/db945b393d40bfa26006) model to detect dogs in images.  Our first line of code downloads the ResNet-50 model, along with weights that have been trained on [ImageNet](http://www.image-net.org/), a very large, very popular dataset used for image classification and other vision tasks.  ImageNet contains over 10 million URLs, each linking to an image containing an object from one of [1000 categories](https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a).  Given an image, this pre-trained ResNet-50 model returns a prediction (derived from the available categories in ImageNet) for the object that is contained in the image.


```python
from keras.applications.resnet50 import ResNet50

# define ResNet50 model
ResNet50_model = ResNet50(weights='imagenet')
```

### Pre-process the Data

When using TensorFlow as backend, Keras CNNs require a 4D array (which we'll also refer to as a 4D tensor) as input, with shape

$$
(\text{nb_samples}, \text{rows}, \text{columns}, \text{channels}),
$$

where `nb_samples` corresponds to the total number of images (or samples), and `rows`, `columns`, and `channels` correspond to the number of rows, columns, and channels for each image, respectively.  

The `path_to_tensor` function below takes a string-valued file path to a color image as input and returns a 4D tensor suitable for supplying to a Keras CNN.  The function first loads the image and resizes it to a square image that is $224 \times 224$ pixels.  Next, the image is converted to an array, which is then resized to a 4D tensor.  In this case, since we are working with color images, each image has three channels.  Likewise, since we are processing a single image (or sample), the returned tensor will always have shape

$$
(1, 224, 224, 3).
$$

The `paths_to_tensor` function takes a numpy array of string-valued image paths as input and returns a 4D tensor with shape 

$$
(\text{nb_samples}, 224, 224, 3).
$$

Here, `nb_samples` is the number of samples, or number of images, in the supplied array of image paths.  It is best to think of `nb_samples` as the number of 3D tensors (where each 3D tensor corresponds to a different image) in your dataset!


```python
from keras.preprocessing import image                  
from tqdm import tqdm

def path_to_tensor(img_path):
    # loads RGB image as PIL.Image.Image type
    img = image.load_img(img_path, target_size=(224, 224))
    # convert PIL.Image.Image type to 3D tensor with shape (224, 224, 3)
    x = image.img_to_array(img)
    # convert 3D tensor to 4D tensor with shape (1, 224, 224, 3) and return 4D tensor
    return np.expand_dims(x, axis=0)

def paths_to_tensor(img_paths):
    list_of_tensors = [path_to_tensor(img_path) for img_path in tqdm(img_paths)]
    return np.vstack(list_of_tensors)
```

### Making Predictions with ResNet-50

Getting the 4D tensor ready for ResNet-50, and for any other pre-trained model in Keras, requires some additional processing.  First, the RGB image is converted to BGR by reordering the channels.  All pre-trained models have the additional normalization step that the mean pixel (expressed in RGB as $[103.939, 116.779, 123.68]$ and calculated from all pixels in all images in ImageNet) must be subtracted from every pixel in each image.  This is implemented in the imported function `preprocess_input`.  If you're curious, you can check the code for `preprocess_input` [here](https://github.com/fchollet/keras/blob/master/keras/applications/imagenet_utils.py).

Now that we have a way to format our image for supplying to ResNet-50, we are now ready to use the model to extract the predictions.  This is accomplished with the `predict` method, which returns an array whose $i$-th entry is the model's predicted probability that the image belongs to the $i$-th ImageNet category.  This is implemented in the `ResNet50_predict_labels` function below.

By taking the argmax of the predicted probability vector, we obtain an integer corresponding to the model's predicted object class, which we can identify with an object category through the use of this [dictionary](https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a). 


```python
from keras.applications.resnet50 import preprocess_input, decode_predictions

def ResNet50_predict_labels(img_path):
    # returns prediction vector for image located at img_path
    img = preprocess_input(path_to_tensor(img_path))
    return np.argmax(ResNet50_model.predict(img))
```

### Write a Dog Detector

While looking at the [dictionary](https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a), you will notice that the categories corresponding to dogs appear in an uninterrupted sequence and correspond to dictionary keys 151-268, inclusive, to include all categories from `'Chihuahua'` to `'Mexican hairless'`.  Thus, in order to check to see if an image is predicted to contain a dog by the pre-trained ResNet-50 model, we need only check if the `ResNet50_predict_labels` function above returns a value between 151 and 268 (inclusive).

We use these ideas to complete the `dog_detector` function below, which returns `True` if a dog is detected in an image (and `False` if not).


```python
### returns "True" if a dog is detected in the image stored at img_path
def dog_detector(img_path):
    prediction = ResNet50_predict_labels(img_path)
    return ((prediction <= 268) & (prediction >= 151)) 
```

### (IMPLEMENTATION) Assess the Dog Detector

__Question 3:__ Use the code cell below to test the performance of your `dog_detector` function.  
- What percentage of the images in `human_files_short` have a detected dog?  
- What percentage of the images in `dog_files_short` have a detected dog?

__Answer:__ 
1 percent of human_files have a detected dog

100 percent of dog_files have a detected dog


```python
### TODO: Test the performance of the dog_detector function
### on the images in human_files_short and dog_files_short.

Count_humans = 0
for i in range(len(human_files_short)):
    if dog_detector(human_files_short[i]) == True:
        Count_humans += 1
        
print("%i percent of human_files have a detected dog" %(Count_humans*100/len(human_files_short)))

Count_dogs = 0
for i in range(len(dog_files_short)):
    if dog_detector(dog_files_short[i]) == True:
        Count_dogs += 1
        
print("%i percent of dog_files have a detected dog" %(Count_dogs*100/len(dog_files_short)))
```

    1 percent of human_files have a detected dog
    100 percent of dog_files have a detected dog
    

---
<a id='step3'></a>
## Step 3: Create a CNN to Classify Dog Breeds (from Scratch)

Now that we have functions for detecting humans and dogs in images, we need a way to predict breed from images.  In this step, you will create a CNN that classifies dog breeds.  You must create your CNN _from scratch_ (so, you can't use transfer learning _yet_!), and you must attain a test accuracy of at least 1%.  In Step 5 of this notebook, you will have the opportunity to use transfer learning to create a CNN that attains greatly improved accuracy.

Be careful with adding too many trainable layers!  More parameters means longer training, which means you are more likely to need a GPU to accelerate the training process.  Thankfully, Keras provides a handy estimate of the time that each epoch is likely to take; you can extrapolate this estimate to figure out how long it will take for your algorithm to train. 

We mention that the task of assigning breed to dogs from images is considered exceptionally challenging.  To see why, consider that *even a human* would have great difficulty in distinguishing between a Brittany and a Welsh Springer Spaniel.  

Brittany | Welsh Springer Spaniel
- | - 
<img src="images/Brittany_02625.jpg" width="100"> | <img src="images/Welsh_springer_spaniel_08203.jpg" width="200">

It is not difficult to find other dog breed pairs with minimal inter-class variation (for instance, Curly-Coated Retrievers and American Water Spaniels).  

Curly-Coated Retriever | American Water Spaniel
- | -
<img src="images/Curly-coated_retriever_03896.jpg" width="200"> | <img src="images/American_water_spaniel_00648.jpg" width="200">


Likewise, recall that labradors come in yellow, chocolate, and black.  Your vision-based algorithm will have to conquer this high intra-class variation to determine how to classify all of these different shades as the same breed.  

Yellow Labrador | Chocolate Labrador | Black Labrador
- | -
<img src="images/Labrador_retriever_06457.jpg" width="150"> | <img src="images/Labrador_retriever_06455.jpg" width="240"> | <img src="images/Labrador_retriever_06449.jpg" width="220">

We also mention that random chance presents an exceptionally low bar: setting aside the fact that the classes are slightly imabalanced, a random guess will provide a correct answer roughly 1 in 133 times, which corresponds to an accuracy of less than 1%.  

Remember that the practice is far ahead of the theory in deep learning.  Experiment with many different architectures, and trust your intuition.  And, of course, have fun! 

### Pre-process the Data

We rescale the images by dividing every pixel in every image by 255.


```python
from PIL import ImageFile                            
ImageFile.LOAD_TRUNCATED_IMAGES = True                 

# pre-process the data for Keras
train_tensors = paths_to_tensor(train_files).astype('float32')/255
valid_tensors = paths_to_tensor(valid_files).astype('float32')/255
test_tensors = paths_to_tensor(test_files).astype('float32')/255
```

    100%|█████████████████████████████████████████████████████████████████████████████| 6680/6680 [01:04<00:00, 103.13it/s]
    100%|███████████████████████████████████████████████████████████████████████████████| 835/835 [00:07<00:00, 114.19it/s]
    100%|███████████████████████████████████████████████████████████████████████████████| 836/836 [00:07<00:00, 114.82it/s]
    

### (IMPLEMENTATION) Model Architecture

Create a CNN to classify dog breed.  At the end of your code cell block, summarize the layers of your model by executing the line:
    
        model.summary()

We have imported some Python modules to get you started, but feel free to import as many modules as you need.  If you end up getting stuck, here's a hint that specifies a model that trains relatively fast on CPU and attains >1% test accuracy in 5 epochs:

![Sample CNN](images/sample_cnn.png)
           
__Question 4:__ Outline the steps you took to get to your final CNN architecture and your reasoning at each step.  If you chose to use the hinted architecture above, describe why you think that CNN architecture should work well for the image classification task.

__Answer:__ Given we are analyzing multi dimensional data the convolutional layers are important for understanding the relationship of pixels near one another. The max pooling layers between each convolutional layer should help avoid overfitting as well as reduce the dimensionality to ensure faster training. Finally the dense fully connected layer at the end of the network with a softmax activation function is critical for ending the neural net with a prediction of the dog-breed.



```python
from keras.layers import Conv2D, MaxPooling2D, GlobalAveragePooling2D
from keras.layers import Dropout, Flatten, Dense
from keras.models import Sequential

model = Sequential()

model.add(Conv2D(filters=16, kernel_size=2, activation='relu', input_shape=(224, 224, 3)))
model.add(MaxPooling2D(pool_size=2))
model.add(Conv2D(filters=32, kernel_size=2, activation='relu'))
model.add(MaxPooling2D(pool_size=2))
model.add(Conv2D(filters=64, kernel_size=2, activation='relu'))
model.add(MaxPooling2D(pool_size=2))
model.add(GlobalAveragePooling2D(data_format=None))
model.add(Dense(133,activation="softmax"))

### TODO: Define your architecture.

model.summary()
```

    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    conv2d_1 (Conv2D)            (None, 223, 223, 16)      208       
    _________________________________________________________________
    max_pooling2d_2 (MaxPooling2 (None, 111, 111, 16)      0         
    _________________________________________________________________
    conv2d_2 (Conv2D)            (None, 110, 110, 32)      2080      
    _________________________________________________________________
    max_pooling2d_3 (MaxPooling2 (None, 55, 55, 32)        0         
    _________________________________________________________________
    conv2d_3 (Conv2D)            (None, 54, 54, 64)        8256      
    _________________________________________________________________
    max_pooling2d_4 (MaxPooling2 (None, 27, 27, 64)        0         
    _________________________________________________________________
    global_average_pooling2d_1 ( (None, 64)                0         
    _________________________________________________________________
    dense_1 (Dense)              (None, 133)               8645      
    =================================================================
    Total params: 19,189.0
    Trainable params: 19,189.0
    Non-trainable params: 0.0
    _________________________________________________________________
    

### Compile the Model


```python
model.compile(optimizer='rmsprop', loss='categorical_crossentropy', metrics=['accuracy'])
```

### (IMPLEMENTATION) Train the Model

Train your model in the code cell below.  Use model checkpointing to save the model that attains the best validation loss.

You are welcome to [augment the training data](https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html), but this is not a requirement. 


```python
from keras.callbacks import ModelCheckpoint  

### TODO: specify the number of epochs that you would like to use to train the model.

epochs = 5

### Do NOT modify the code below this line.

checkpointer = ModelCheckpoint(filepath='saved_models/weights.best.from_scratch.hdf5', 
                               verbose=1, save_best_only=True)

model.fit(train_tensors, train_targets, 
          validation_data=(valid_tensors, valid_targets),
          epochs=epochs, batch_size=20, callbacks=[checkpointer], verbose=1)
```

    Train on 6680 samples, validate on 835 samples
    Epoch 1/5
    6660/6680 [============================>.] - ETA: 395s - loss: 4.9037 - acc: 0.0000e+00 - ETA: 329s - loss: 4.8980 - acc: 0.0000e+00 - ETA: 306s - loss: 4.8921 - acc: 0.0000e+00 - ETA: 295s - loss: 4.8949 - acc: 0.0000e+00 - ETA: 287s - loss: 4.8920 - acc: 0.0000e+00 - ETA: 282s - loss: 4.8925 - acc: 0.0000e+00 - ETA: 278s - loss: 4.8916 - acc: 0.0000e+00 - ETA: 276s - loss: 4.8901 - acc: 0.0000e+00 - ETA: 275s - loss: 4.8916 - acc: 0.0000e+00 - ETA: 276s - loss: 4.8916 - acc: 0.0000e+00 - ETA: 277s - loss: 4.8905 - acc: 0.0000e+00 - ETA: 276s - loss: 4.8891 - acc: 0.0042     - ETA: 273s - loss: 4.8891 - acc: 0.0038 - ETA: 271s - loss: 4.8890 - acc: 0.0036 - ETA: 268s - loss: 4.8895 - acc: 0.0033 - ETA: 267s - loss: 4.8871 - acc: 0.0063 - ETA: 267s - loss: 4.8868 - acc: 0.0059 - ETA: 267s - loss: 4.8869 - acc: 0.0056 - ETA: 266s - loss: 4.8866 - acc: 0.0053 - ETA: 266s - loss: 4.8857 - acc: 0.0075 - ETA: 266s - loss: 4.8867 - acc: 0.0071 - ETA: 265s - loss: 4.8861 - acc: 0.0091 - ETA: 265s - loss: 4.8869 - acc: 0.0087 - ETA: 264s - loss: 4.8875 - acc: 0.0083 - ETA: 263s - loss: 4.8880 - acc: 0.0080 - ETA: 262s - loss: 4.8880 - acc: 0.0077 - ETA: 261s - loss: 4.8879 - acc: 0.0074 - ETA: 260s - loss: 4.8877 - acc: 0.0071 - ETA: 259s - loss: 4.8883 - acc: 0.0069 - ETA: 258s - loss: 4.8882 - acc: 0.0083 - ETA: 258s - loss: 4.8888 - acc: 0.0081 - ETA: 257s - loss: 4.8884 - acc: 0.0078 - ETA: 256s - loss: 4.8881 - acc: 0.0076 - ETA: 255s - loss: 4.8871 - acc: 0.0088 - ETA: 254s - loss: 4.8872 - acc: 0.0086 - ETA: 253s - loss: 4.8867 - acc: 0.0083 - ETA: 252s - loss: 4.8865 - acc: 0.0081 - ETA: 252s - loss: 4.8864 - acc: 0.0079 - ETA: 251s - loss: 4.8871 - acc: 0.0077 - ETA: 250s - loss: 4.8872 - acc: 0.0075 - ETA: 249s - loss: 4.8875 - acc: 0.0073 - ETA: 248s - loss: 4.8878 - acc: 0.0071 - ETA: 247s - loss: 4.8884 - acc: 0.0070 - ETA: 246s - loss: 4.8888 - acc: 0.0068 - ETA: 245s - loss: 4.8886 - acc: 0.0067 - ETA: 245s - loss: 4.8888 - acc: 0.0065 - ETA: 244s - loss: 4.8886 - acc: 0.0074 - ETA: 243s - loss: 4.8889 - acc: 0.0073 - ETA: 242s - loss: 4.8890 - acc: 0.0071 - ETA: 241s - loss: 4.8895 - acc: 0.0070 - ETA: 240s - loss: 4.8895 - acc: 0.0069 - ETA: 240s - loss: 4.8890 - acc: 0.0067 - ETA: 239s - loss: 4.8886 - acc: 0.0066 - ETA: 238s - loss: 4.8888 - acc: 0.0074 - ETA: 237s - loss: 4.8887 - acc: 0.0073 - ETA: 236s - loss: 4.8891 - acc: 0.0071 - ETA: 235s - loss: 4.8889 - acc: 0.0088 - ETA: 235s - loss: 4.8889 - acc: 0.0086 - ETA: 234s - loss: 4.8888 - acc: 0.0085 - ETA: 233s - loss: 4.8895 - acc: 0.0083 - ETA: 233s - loss: 4.8892 - acc: 0.0090 - ETA: 232s - loss: 4.8893 - acc: 0.0089 - ETA: 232s - loss: 4.8894 - acc: 0.0087 - ETA: 231s - loss: 4.8896 - acc: 0.0086 - ETA: 230s - loss: 4.8898 - acc: 0.0085 - ETA: 229s - loss: 4.8896 - acc: 0.0083 - ETA: 228s - loss: 4.8896 - acc: 0.0082 - ETA: 227s - loss: 4.8900 - acc: 0.0081 - ETA: 227s - loss: 4.8901 - acc: 0.0080 - ETA: 226s - loss: 4.8899 - acc: 0.0079 - ETA: 225s - loss: 4.8896 - acc: 0.0077 - ETA: 224s - loss: 4.8894 - acc: 0.0076 - ETA: 223s - loss: 4.8893 - acc: 0.0075 - ETA: 222s - loss: 4.8893 - acc: 0.0074 - ETA: 222s - loss: 4.8889 - acc: 0.0073 - ETA: 221s - loss: 4.8885 - acc: 0.0079 - ETA: 220s - loss: 4.8881 - acc: 0.0084 - ETA: 219s - loss: 4.8881 - acc: 0.0083 - ETA: 218s - loss: 4.8881 - acc: 0.0082 - ETA: 217s - loss: 4.8880 - acc: 0.0081 - ETA: 216s - loss: 4.8877 - acc: 0.0080 - ETA: 216s - loss: 4.8879 - acc: 0.0079 - ETA: 215s - loss: 4.8881 - acc: 0.0084 - ETA: 214s - loss: 4.8883 - acc: 0.0083 - ETA: 213s - loss: 4.8881 - acc: 0.0082 - ETA: 212s - loss: 4.8879 - acc: 0.0081 - ETA: 212s - loss: 4.8877 - acc: 0.0080 - ETA: 211s - loss: 4.8876 - acc: 0.0080 - ETA: 210s - loss: 4.8873 - acc: 0.0079 - ETA: 210s - loss: 4.8877 - acc: 0.0078 - ETA: 209s - loss: 4.8880 - acc: 0.0077 - ETA: 208s - loss: 4.8881 - acc: 0.0076 - ETA: 208s - loss: 4.8878 - acc: 0.0075 - ETA: 207s - loss: 4.8877 - acc: 0.0074 - ETA: 206s - loss: 4.8878 - acc: 0.0074 - ETA: 205s - loss: 4.8875 - acc: 0.0073 - ETA: 204s - loss: 4.8872 - acc: 0.0072 - ETA: 204s - loss: 4.8870 - acc: 0.0077 - ETA: 203s - loss: 4.8872 - acc: 0.0076 - ETA: 202s - loss: 4.8868 - acc: 0.0080 - ETA: 201s - loss: 4.8870 - acc: 0.0079 - ETA: 200s - loss: 4.8873 - acc: 0.0078 - ETA: 199s - loss: 4.8868 - acc: 0.0078 - ETA: 199s - loss: 4.8870 - acc: 0.0077 - ETA: 198s - loss: 4.8866 - acc: 0.0076 - ETA: 197s - loss: 4.8867 - acc: 0.0075 - ETA: 196s - loss: 4.8869 - acc: 0.0075 - ETA: 195s - loss: 4.8870 - acc: 0.0074 - ETA: 195s - loss: 4.8867 - acc: 0.0078 - ETA: 194s - loss: 4.8864 - acc: 0.0077 - ETA: 193s - loss: 4.8863 - acc: 0.0077 - ETA: 192s - loss: 4.8861 - acc: 0.0076 - ETA: 191s - loss: 4.8860 - acc: 0.0075 - ETA: 190s - loss: 4.8862 - acc: 0.0075 - ETA: 190s - loss: 4.8859 - acc: 0.0078 - ETA: 189s - loss: 4.8857 - acc: 0.0078 - ETA: 188s - loss: 4.8860 - acc: 0.0077 - ETA: 187s - loss: 4.8861 - acc: 0.0081 - ETA: 186s - loss: 4.8863 - acc: 0.0084 - ETA: 186s - loss: 4.8864 - acc: 0.0083 - ETA: 185s - loss: 4.8863 - acc: 0.0083 - ETA: 184s - loss: 4.8865 - acc: 0.0082 - ETA: 183s - loss: 4.8869 - acc: 0.0081 - ETA: 182s - loss: 4.8868 - acc: 0.0081 - ETA: 181s - loss: 4.8868 - acc: 0.0080 - ETA: 181s - loss: 4.8866 - acc: 0.0083 - ETA: 180s - loss: 4.8868 - acc: 0.0083 - ETA: 179s - loss: 4.8868 - acc: 0.0082 - ETA: 178s - loss: 4.8868 - acc: 0.0081 - ETA: 178s - loss: 4.8865 - acc: 0.0081 - ETA: 177s - loss: 4.8868 - acc: 0.0080 - ETA: 176s - loss: 4.8869 - acc: 0.0080 - ETA: 175s - loss: 4.8869 - acc: 0.0079 - ETA: 175s - loss: 4.8869 - acc: 0.0078 - ETA: 174s - loss: 4.8867 - acc: 0.0078 - ETA: 173s - loss: 4.8868 - acc: 0.0077 - ETA: 172s - loss: 4.8869 - acc: 0.0077 - ETA: 171s - loss: 4.8871 - acc: 0.0076 - ETA: 170s - loss: 4.8871 - acc: 0.0076 - ETA: 170s - loss: 4.8869 - acc: 0.0075 - ETA: 169s - loss: 4.8867 - acc: 0.0074 - ETA: 168s - loss: 4.8868 - acc: 0.0074 - ETA: 167s - loss: 4.8866 - acc: 0.0073 - ETA: 166s - loss: 4.8862 - acc: 0.0073 - ETA: 166s - loss: 4.8861 - acc: 0.0076 - ETA: 165s - loss: 4.8861 - acc: 0.0075 - ETA: 164s - loss: 4.8860 - acc: 0.0075 - ETA: 163s - loss: 4.8860 - acc: 0.0074 - ETA: 162s - loss: 4.8860 - acc: 0.0074 - ETA: 162s - loss: 4.8857 - acc: 0.0073 - ETA: 161s - loss: 4.8859 - acc: 0.0073 - ETA: 160s - loss: 4.8862 - acc: 0.0072 - ETA: 159s - loss: 4.8861 - acc: 0.0072 - ETA: 158s - loss: 4.8862 - acc: 0.0075 - ETA: 158s - loss: 4.8861 - acc: 0.0074 - ETA: 157s - loss: 4.8861 - acc: 0.0074 - ETA: 156s - loss: 4.8859 - acc: 0.0073 - ETA: 155s - loss: 4.8858 - acc: 0.0076 - ETA: 154s - loss: 4.8857 - acc: 0.0075 - ETA: 153s - loss: 4.8853 - acc: 0.0081 - ETA: 153s - loss: 4.8853 - acc: 0.0081 - ETA: 152s - loss: 4.8851 - acc: 0.0080 - ETA: 151s - loss: 4.8853 - acc: 0.0080 - ETA: 150s - loss: 4.8853 - acc: 0.0079 - ETA: 149s - loss: 4.8853 - acc: 0.0079 - ETA: 149s - loss: 4.8852 - acc: 0.0078 - ETA: 148s - loss: 4.8851 - acc: 0.0087 - ETA: 147s - loss: 4.8851 - acc: 0.0086 - ETA: 146s - loss: 4.8849 - acc: 0.0086 - ETA: 145s - loss: 4.8851 - acc: 0.0085 - ETA: 145s - loss: 4.8850 - acc: 0.0085 - ETA: 144s - loss: 4.8852 - acc: 0.0084 - ETA: 143s - loss: 4.8848 - acc: 0.0084 - ETA: 142s - loss: 4.8848 - acc: 0.0083 - ETA: 141s - loss: 4.8847 - acc: 0.0083 - ETA: 141s - loss: 4.8849 - acc: 0.0085 - ETA: 140s - loss: 4.8845 - acc: 0.0085 - ETA: 139s - loss: 4.8846 - acc: 0.0087 - ETA: 138s - loss: 4.8848 - acc: 0.0087 - ETA: 137s - loss: 4.8849 - acc: 0.0086 - ETA: 137s - loss: 4.8847 - acc: 0.0088 - ETA: 136s - loss: 4.8848 - acc: 0.0088 - ETA: 135s - loss: 4.8846 - acc: 0.0090 - ETA: 134s - loss: 4.8843 - acc: 0.0090 - ETA: 133s - loss: 4.8838 - acc: 0.0089 - ETA: 133s - loss: 4.8836 - acc: 0.0089 - ETA: 132s - loss: 4.8836 - acc: 0.0091 - ETA: 131s - loss: 4.8832 - acc: 0.0090 - ETA: 130s - loss: 4.8828 - acc: 0.0090 - ETA: 129s - loss: 4.8826 - acc: 0.0089 - ETA: 128s - loss: 4.8829 - acc: 0.0089 - ETA: 128s - loss: 4.8831 - acc: 0.0089 - ETA: 127s - loss: 4.8827 - acc: 0.0091 - ETA: 126s - loss: 4.8830 - acc: 0.0090 - ETA: 125s - loss: 4.8833 - acc: 0.0090 - ETA: 124s - loss: 4.8833 - acc: 0.0089 - ETA: 124s - loss: 4.8836 - acc: 0.0089 - ETA: 123s - loss: 4.8836 - acc: 0.0088 - ETA: 122s - loss: 4.8834 - acc: 0.0093 - ETA: 121s - loss: 4.8835 - acc: 0.0093 - ETA: 120s - loss: 4.8833 - acc: 0.0092 - ETA: 119s - loss: 4.8836 - acc: 0.0092 - ETA: 119s - loss: 4.8836 - acc: 0.0091 - ETA: 118s - loss: 4.8834 - acc: 0.0093 - ETA: 117s - loss: 4.8834 - acc: 0.0093 - ETA: 116s - loss: 4.8833 - acc: 0.0095 - ETA: 115s - loss: 4.8835 - acc: 0.0094 - ETA: 114s - loss: 4.8834 - acc: 0.0094 - ETA: 114s - loss: 4.8835 - acc: 0.0093 - ETA: 113s - loss: 4.8835 - acc: 0.0093 - ETA: 112s - loss: 4.8835 - acc: 0.0092 - ETA: 111s - loss: 4.8835 - acc: 0.0092 - ETA: 110s - loss: 4.8838 - acc: 0.0092 - ETA: 110s - loss: 4.8836 - acc: 0.0091 - ETA: 109s - loss: 4.8835 - acc: 0.0091 - ETA: 108s - loss: 4.8833 - acc: 0.0095 - ETA: 107s - loss: 4.8832 - acc: 0.0094 - ETA: 106s - loss: 4.8832 - acc: 0.0094 - ETA: 105s - loss: 4.8831 - acc: 0.0094 - ETA: 104s - loss: 4.8829 - acc: 0.0093 - ETA: 104s - loss: 4.8829 - acc: 0.0093 - ETA: 103s - loss: 4.8830 - acc: 0.0092 - ETA: 102s - loss: 4.8829 - acc: 0.0092 - ETA: 101s - loss: 4.8830 - acc: 0.0092 - ETA: 100s - loss: 4.8828 - acc: 0.0091 - ETA: 99s - loss: 4.8829 - acc: 0.0091  - ETA: 99s - loss: 4.8828 - acc: 0.0090 - ETA: 98s - loss: 4.8828 - acc: 0.0090 - ETA: 97s - loss: 4.8828 - acc: 0.0090 - ETA: 96s - loss: 4.8830 - acc: 0.0089 - ETA: 95s - loss: 4.8830 - acc: 0.0091 - ETA: 94s - loss: 4.8829 - acc: 0.0091 - ETA: 93s - loss: 4.8828 - acc: 0.0090 - ETA: 92s - loss: 4.8830 - acc: 0.0090 - ETA: 92s - loss: 4.8829 - acc: 0.0089 - ETA: 91s - loss: 4.8828 - acc: 0.0091 - ETA: 90s - loss: 4.8826 - acc: 0.0091 - ETA: 89s - loss: 4.8823 - acc: 0.0092 - ETA: 88s - loss: 4.8822 - acc: 0.0092 - ETA: 87s - loss: 4.8822 - acc: 0.0092 - ETA: 86s - loss: 4.8822 - acc: 0.0091 - ETA: 85s - loss: 4.8821 - acc: 0.0091 - ETA: 84s - loss: 4.8821 - acc: 0.0093 - ETA: 84s - loss: 4.8819 - acc: 0.0092 - ETA: 83s - loss: 4.8817 - acc: 0.0092 - ETA: 82s - loss: 4.8819 - acc: 0.0091 - ETA: 81s - loss: 4.8816 - acc: 0.0091 - ETA: 80s - loss: 4.8815 - acc: 0.0091 - ETA: 79s - loss: 4.8817 - acc: 0.0090 - ETA: 78s - loss: 4.8819 - acc: 0.0090 - ETA: 77s - loss: 4.8819 - acc: 0.0090 - ETA: 77s - loss: 4.8820 - acc: 0.0089 - ETA: 76s - loss: 4.8820 - acc: 0.0089 - ETA: 75s - loss: 4.8821 - acc: 0.0089 - ETA: 74s - loss: 4.8823 - acc: 0.0088 - ETA: 73s - loss: 4.8823 - acc: 0.0088 - ETA: 72s - loss: 4.8821 - acc: 0.0088 - ETA: 71s - loss: 4.8822 - acc: 0.0087 - ETA: 70s - loss: 4.8823 - acc: 0.0087 - ETA: 69s - loss: 4.8822 - acc: 0.0087 - ETA: 69s - loss: 4.8823 - acc: 0.0088 - ETA: 68s - loss: 4.8824 - acc: 0.0088 - ETA: 67s - loss: 4.8824 - acc: 0.0087 - ETA: 66s - loss: 4.8825 - acc: 0.0087 - ETA: 65s - loss: 4.8823 - acc: 0.0089 - ETA: 64s - loss: 4.8821 - acc: 0.0088 - ETA: 63s - loss: 4.8821 - acc: 0.0088 - ETA: 62s - loss: 4.8820 - acc: 0.0088 - ETA: 61s - loss: 4.8818 - acc: 0.0087 - ETA: 60s - loss: 4.8815 - acc: 0.0087 - ETA: 60s - loss: 4.8815 - acc: 0.0087 - ETA: 59s - loss: 4.8815 - acc: 0.0086 - ETA: 58s - loss: 4.8816 - acc: 0.0086 - ETA: 57s - loss: 4.8815 - acc: 0.0086 - ETA: 56s - loss: 4.8814 - acc: 0.0085 - ETA: 55s - loss: 4.8815 - acc: 0.0085 - ETA: 54s - loss: 4.8814 - acc: 0.0085 - ETA: 53s - loss: 4.8817 - acc: 0.0086 - ETA: 52s - loss: 4.8819 - acc: 0.0086 - ETA: 51s - loss: 4.8819 - acc: 0.0088 - ETA: 50s - loss: 4.8818 - acc: 0.0087 - ETA: 49s - loss: 4.8817 - acc: 0.0089 - ETA: 48s - loss: 4.8818 - acc: 0.0088 - ETA: 48s - loss: 4.8817 - acc: 0.0088 - ETA: 47s - loss: 4.8816 - acc: 0.0088 - ETA: 46s - loss: 4.8814 - acc: 0.0087 - ETA: 45s - loss: 4.8814 - acc: 0.0087 - ETA: 44s - loss: 4.8814 - acc: 0.0087 - ETA: 43s - loss: 4.8813 - acc: 0.0087 - ETA: 42s - loss: 4.8812 - acc: 0.0086 - ETA: 41s - loss: 4.8812 - acc: 0.0086 - ETA: 40s - loss: 4.8813 - acc: 0.0086 - ETA: 39s - loss: 4.8811 - acc: 0.0085 - ETA: 38s - loss: 4.8811 - acc: 0.0085 - ETA: 37s - loss: 4.8810 - acc: 0.0085 - ETA: 36s - loss: 4.8808 - acc: 0.0084 - ETA: 35s - loss: 4.8806 - acc: 0.0084 - ETA: 34s - loss: 4.8807 - acc: 0.0084 - ETA: 33s - loss: 4.8806 - acc: 0.0085 - ETA: 33s - loss: 4.8805 - acc: 0.0085 - ETA: 32s - loss: 4.8802 - acc: 0.0085 - ETA: 31s - loss: 4.8801 - acc: 0.0084 - ETA: 30s - loss: 4.8800 - acc: 0.0084 - ETA: 29s - loss: 4.8802 - acc: 0.0084 - ETA: 28s - loss: 4.8800 - acc: 0.0084 - ETA: 27s - loss: 4.8800 - acc: 0.0083 - ETA: 26s - loss: 4.8801 - acc: 0.0083 - ETA: 25s - loss: 4.8801 - acc: 0.0083 - ETA: 24s - loss: 4.8803 - acc: 0.0083 - ETA: 23s - loss: 4.8803 - acc: 0.0082 - ETA: 22s - loss: 4.8802 - acc: 0.0082 - ETA: 21s - loss: 4.8802 - acc: 0.0082 - ETA: 20s - loss: 4.8803 - acc: 0.0081 - ETA: 19s - loss: 4.8800 - acc: 0.0081 - ETA: 18s - loss: 4.8798 - acc: 0.0081 - ETA: 17s - loss: 4.8798 - acc: 0.0081 - ETA: 16s - loss: 4.8798 - acc: 0.0082 - ETA: 15s - loss: 4.8797 - acc: 0.0082 - ETA: 14s - loss: 4.8797 - acc: 0.0083 - ETA: 13s - loss: 4.8798 - acc: 0.0083 - ETA: 12s - loss: 4.8796 - acc: 0.0084 - ETA: 11s - loss: 4.8796 - acc: 0.0084 - ETA: 10s - loss: 4.8797 - acc: 0.0084 - ETA: 9s - loss: 4.8795 - acc: 0.0083  - ETA: 8s - loss: 4.8797 - acc: 0.0083 - ETA: 7s - loss: 4.8796 - acc: 0.0084 - ETA: 6s - loss: 4.8796 - acc: 0.0084 - ETA: 5s - loss: 4.8796 - acc: 0.0085 - ETA: 4s - loss: 4.8795 - acc: 0.0087 - ETA: 3s - loss: 4.8794 - acc: 0.0088 - ETA: 2s - loss: 4.8792 - acc: 0.0088 - ETA: 1s - loss: 4.8791 - acc: 0.0087 - ETA: 0s - loss: 4.8790 - acc: 0.0087Epoch 00000: val_loss improved from inf to 4.85772, saving model to saved_models/weights.best.from_scratch.hdf5
    6680/6680 [==============================] - 341s - loss: 4.8791 - acc: 0.0087 - val_loss: 4.8577 - val_acc: 0.0120
    Epoch 2/5
    6660/6680 [============================>.] - ETA: 291s - loss: 4.8916 - acc: 0.0000e+00 - ETA: 290s - loss: 4.8457 - acc: 0.0000e+00 - ETA: 286s - loss: 4.8439 - acc: 0.0000e+00 - ETA: 283s - loss: 4.8331 - acc: 0.0000e+00 - ETA: 282s - loss: 4.8241 - acc: 0.0000e+00 - ETA: 281s - loss: 4.8258 - acc: 0.0000e+00 - ETA: 281s - loss: 4.8274 - acc: 0.0000e+00 - ETA: 278s - loss: 4.8250 - acc: 0.0000e+00 - ETA: 278s - loss: 4.8357 - acc: 0.0000e+00 - ETA: 277s - loss: 4.8508 - acc: 0.0000e+00 - ETA: 277s - loss: 4.8507 - acc: 0.0000e+00 - ETA: 276s - loss: 4.8522 - acc: 0.0042     - ETA: 276s - loss: 4.8508 - acc: 0.0038 - ETA: 276s - loss: 4.8507 - acc: 0.0036 - ETA: 276s - loss: 4.8495 - acc: 0.0033 - ETA: 275s - loss: 4.8507 - acc: 0.0031 - ETA: 275s - loss: 4.8491 - acc: 0.0029 - ETA: 277s - loss: 4.8501 - acc: 0.0028 - ETA: 277s - loss: 4.8510 - acc: 0.0026 - ETA: 280s - loss: 4.8512 - acc: 0.0025 - ETA: 282s - loss: 4.8502 - acc: 0.0024 - ETA: 282s - loss: 4.8458 - acc: 0.0023 - ETA: 283s - loss: 4.8465 - acc: 0.0022 - ETA: 281s - loss: 4.8461 - acc: 0.0021 - ETA: 280s - loss: 4.8441 - acc: 0.0020 - ETA: 278s - loss: 4.8444 - acc: 0.0019 - ETA: 277s - loss: 4.8449 - acc: 0.0019 - ETA: 276s - loss: 4.8427 - acc: 0.0018 - ETA: 275s - loss: 4.8430 - acc: 0.0017 - ETA: 274s - loss: 4.8461 - acc: 0.0017 - ETA: 273s - loss: 4.8498 - acc: 0.0032 - ETA: 272s - loss: 4.8464 - acc: 0.0031 - ETA: 270s - loss: 4.8451 - acc: 0.0030 - ETA: 270s - loss: 4.8461 - acc: 0.0044 - ETA: 268s - loss: 4.8477 - acc: 0.0057 - ETA: 267s - loss: 4.8480 - acc: 0.0056 - ETA: 266s - loss: 4.8461 - acc: 0.0068 - ETA: 264s - loss: 4.8467 - acc: 0.0066 - ETA: 263s - loss: 4.8456 - acc: 0.0077 - ETA: 262s - loss: 4.8468 - acc: 0.0088 - ETA: 261s - loss: 4.8469 - acc: 0.0085 - ETA: 259s - loss: 4.8474 - acc: 0.0083 - ETA: 258s - loss: 4.8463 - acc: 0.0081 - ETA: 257s - loss: 4.8450 - acc: 0.0080 - ETA: 256s - loss: 4.8473 - acc: 0.0078 - ETA: 255s - loss: 4.8475 - acc: 0.0076 - ETA: 254s - loss: 4.8486 - acc: 0.0085 - ETA: 253s - loss: 4.8473 - acc: 0.0083 - ETA: 252s - loss: 4.8481 - acc: 0.0092 - ETA: 251s - loss: 4.8479 - acc: 0.0090 - ETA: 250s - loss: 4.8505 - acc: 0.0088 - ETA: 250s - loss: 4.8479 - acc: 0.0087 - ETA: 249s - loss: 4.8498 - acc: 0.0085 - ETA: 248s - loss: 4.8494 - acc: 0.0093 - ETA: 247s - loss: 4.8504 - acc: 0.0091 - ETA: 246s - loss: 4.8516 - acc: 0.0089 - ETA: 245s - loss: 4.8519 - acc: 0.0088 - ETA: 244s - loss: 4.8516 - acc: 0.0095 - ETA: 243s - loss: 4.8524 - acc: 0.0093 - ETA: 242s - loss: 4.8517 - acc: 0.0092 - ETA: 241s - loss: 4.8518 - acc: 0.0090 - ETA: 240s - loss: 4.8522 - acc: 0.0089 - ETA: 239s - loss: 4.8510 - acc: 0.0087 - ETA: 238s - loss: 4.8497 - acc: 0.0102 - ETA: 237s - loss: 4.8506 - acc: 0.0108 - ETA: 236s - loss: 4.8503 - acc: 0.0114 - ETA: 236s - loss: 4.8492 - acc: 0.0112 - ETA: 235s - loss: 4.8505 - acc: 0.0110 - ETA: 234s - loss: 4.8486 - acc: 0.0109 - ETA: 233s - loss: 4.8490 - acc: 0.0107 - ETA: 232s - loss: 4.8480 - acc: 0.0113 - ETA: 231s - loss: 4.8490 - acc: 0.0111 - ETA: 230s - loss: 4.8490 - acc: 0.0110 - ETA: 229s - loss: 4.8481 - acc: 0.0108 - ETA: 228s - loss: 4.8477 - acc: 0.0107 - ETA: 227s - loss: 4.8469 - acc: 0.0105 - ETA: 226s - loss: 4.8486 - acc: 0.0104 - ETA: 225s - loss: 4.8484 - acc: 0.0109 - ETA: 224s - loss: 4.8494 - acc: 0.0108 - ETA: 223s - loss: 4.8501 - acc: 0.0106 - ETA: 222s - loss: 4.8487 - acc: 0.0111 - ETA: 221s - loss: 4.8494 - acc: 0.0110 - ETA: 220s - loss: 4.8490 - acc: 0.0108 - ETA: 220s - loss: 4.8490 - acc: 0.0113 - ETA: 219s - loss: 4.8487 - acc: 0.0112 - ETA: 218s - loss: 4.8489 - acc: 0.0110 - ETA: 217s - loss: 4.8497 - acc: 0.0109 - ETA: 216s - loss: 4.8499 - acc: 0.0108 - ETA: 215s - loss: 4.8494 - acc: 0.0107 - ETA: 214s - loss: 4.8496 - acc: 0.0106 - ETA: 213s - loss: 4.8494 - acc: 0.0104 - ETA: 213s - loss: 4.8502 - acc: 0.0103 - ETA: 212s - loss: 4.8498 - acc: 0.0113 - ETA: 211s - loss: 4.8492 - acc: 0.0112 - ETA: 210s - loss: 4.8487 - acc: 0.0111 - ETA: 209s - loss: 4.8495 - acc: 0.0109 - ETA: 208s - loss: 4.8494 - acc: 0.0108 - ETA: 207s - loss: 4.8487 - acc: 0.0107 - ETA: 206s - loss: 4.8488 - acc: 0.0106 - ETA: 206s - loss: 4.8489 - acc: 0.0105 - ETA: 205s - loss: 4.8489 - acc: 0.0114 - ETA: 204s - loss: 4.8481 - acc: 0.0113 - ETA: 203s - loss: 4.8487 - acc: 0.0112 - ETA: 202s - loss: 4.8486 - acc: 0.0111 - ETA: 201s - loss: 4.8475 - acc: 0.0110 - ETA: 200s - loss: 4.8471 - acc: 0.0108 - ETA: 199s - loss: 4.8466 - acc: 0.0107 - ETA: 198s - loss: 4.8468 - acc: 0.0111 - ETA: 197s - loss: 4.8468 - acc: 0.0110 - ETA: 196s - loss: 4.8476 - acc: 0.0114 - ETA: 195s - loss: 4.8475 - acc: 0.0113 - ETA: 195s - loss: 4.8474 - acc: 0.0112 - ETA: 194s - loss: 4.8471 - acc: 0.0115 - ETA: 193s - loss: 4.8475 - acc: 0.0118 - ETA: 192s - loss: 4.8483 - acc: 0.0117 - ETA: 191s - loss: 4.8488 - acc: 0.0116 - ETA: 190s - loss: 4.8485 - acc: 0.0115 - ETA: 189s - loss: 4.8490 - acc: 0.0114 - ETA: 188s - loss: 4.8485 - acc: 0.0118 - ETA: 187s - loss: 4.8481 - acc: 0.0117 - ETA: 186s - loss: 4.8475 - acc: 0.0120 - ETA: 185s - loss: 4.8470 - acc: 0.0119 - ETA: 184s - loss: 4.8462 - acc: 0.0118 - ETA: 183s - loss: 4.8462 - acc: 0.0117 - ETA: 183s - loss: 4.8465 - acc: 0.0116 - ETA: 182s - loss: 4.8474 - acc: 0.0115 - ETA: 181s - loss: 4.8464 - acc: 0.0114 - ETA: 180s - loss: 4.8469 - acc: 0.0113 - ETA: 179s - loss: 4.8474 - acc: 0.0112 - ETA: 178s - loss: 4.8474 - acc: 0.0115 - ETA: 177s - loss: 4.8476 - acc: 0.0118 - ETA: 176s - loss: 4.8476 - acc: 0.0117 - ETA: 175s - loss: 4.8477 - acc: 0.0117 - ETA: 175s - loss: 4.8473 - acc: 0.0116 - ETA: 174s - loss: 4.8471 - acc: 0.0115 - ETA: 173s - loss: 4.8468 - acc: 0.0118 - ETA: 172s - loss: 4.8472 - acc: 0.0117 - ETA: 171s - loss: 4.8470 - acc: 0.0116 - ETA: 170s - loss: 4.8472 - acc: 0.0119 - ETA: 169s - loss: 4.8477 - acc: 0.0118 - ETA: 168s - loss: 4.8474 - acc: 0.0117 - ETA: 168s - loss: 4.8471 - acc: 0.0116 - ETA: 167s - loss: 4.8465 - acc: 0.0119 - ETA: 166s - loss: 4.8466 - acc: 0.0118 - ETA: 165s - loss: 4.8461 - acc: 0.0117 - ETA: 164s - loss: 4.8456 - acc: 0.0116 - ETA: 163s - loss: 4.8460 - acc: 0.0119 - ETA: 162s - loss: 4.8459 - acc: 0.0125 - ETA: 161s - loss: 4.8463 - acc: 0.0124 - ETA: 160s - loss: 4.8458 - acc: 0.0123 - ETA: 160s - loss: 4.8457 - acc: 0.0123 - ETA: 159s - loss: 4.8452 - acc: 0.0122 - ETA: 158s - loss: 4.8455 - acc: 0.0121 - ETA: 157s - loss: 4.8461 - acc: 0.0120 - ETA: 156s - loss: 4.8463 - acc: 0.0119 - ETA: 156s - loss: 4.8468 - acc: 0.0119 - ETA: 155s - loss: 4.8467 - acc: 0.0121 - ETA: 154s - loss: 4.8471 - acc: 0.0123 - ETA: 153s - loss: 4.8460 - acc: 0.0126 - ETA: 153s - loss: 4.8463 - acc: 0.0125 - ETA: 152s - loss: 4.8458 - acc: 0.0124 - ETA: 151s - loss: 4.8456 - acc: 0.0123 - ETA: 150s - loss: 4.8459 - acc: 0.0123 - ETA: 149s - loss: 4.8461 - acc: 0.0125 - ETA: 149s - loss: 4.8464 - acc: 0.0124 - ETA: 148s - loss: 4.8468 - acc: 0.0123 - ETA: 147s - loss: 4.8469 - acc: 0.0123 - ETA: 146s - loss: 4.8469 - acc: 0.0122 - ETA: 145s - loss: 4.8472 - acc: 0.0121 - ETA: 144s - loss: 4.8471 - acc: 0.0124 - ETA: 143s - loss: 4.8477 - acc: 0.0123 - ETA: 142s - loss: 4.8476 - acc: 0.0125 - ETA: 142s - loss: 4.8482 - acc: 0.0124 - ETA: 141s - loss: 4.8482 - acc: 0.0124 - ETA: 140s - loss: 4.8481 - acc: 0.0123 - ETA: 139s - loss: 4.8480 - acc: 0.0122 - ETA: 138s - loss: 4.8481 - acc: 0.0121 - ETA: 137s - loss: 4.8476 - acc: 0.0124 - ETA: 136s - loss: 4.8474 - acc: 0.0123 - ETA: 135s - loss: 4.8474 - acc: 0.0122 - ETA: 135s - loss: 4.8476 - acc: 0.0122 - ETA: 134s - loss: 4.8478 - acc: 0.0121 - ETA: 133s - loss: 4.8473 - acc: 0.0120 - ETA: 132s - loss: 4.8470 - acc: 0.0120 - ETA: 131s - loss: 4.8468 - acc: 0.0119 - ETA: 130s - loss: 4.8469 - acc: 0.0124 - ETA: 129s - loss: 4.8462 - acc: 0.0123 - ETA: 128s - loss: 4.8455 - acc: 0.0122 - ETA: 127s - loss: 4.8458 - acc: 0.0122 - ETA: 126s - loss: 4.8461 - acc: 0.0124 - ETA: 126s - loss: 4.8458 - acc: 0.0123 - ETA: 125s - loss: 4.8459 - acc: 0.0122 - ETA: 124s - loss: 4.8461 - acc: 0.0124 - ETA: 123s - loss: 4.8464 - acc: 0.0124 - ETA: 122s - loss: 4.8462 - acc: 0.0123 - ETA: 121s - loss: 4.8459 - acc: 0.0125 - ETA: 120s - loss: 4.8463 - acc: 0.0124 - ETA: 119s - loss: 4.8460 - acc: 0.0124 - ETA: 118s - loss: 4.8462 - acc: 0.0123 - ETA: 118s - loss: 4.8460 - acc: 0.0123 - ETA: 117s - loss: 4.8460 - acc: 0.0122 - ETA: 116s - loss: 4.8460 - acc: 0.0121 - ETA: 115s - loss: 4.8461 - acc: 0.0121 - ETA: 114s - loss: 4.8456 - acc: 0.0120 - ETA: 113s - loss: 4.8456 - acc: 0.0120 - ETA: 112s - loss: 4.8459 - acc: 0.0119 - ETA: 111s - loss: 4.8459 - acc: 0.0121 - ETA: 110s - loss: 4.8458 - acc: 0.0120 - ETA: 110s - loss: 4.8459 - acc: 0.0120 - ETA: 109s - loss: 4.8462 - acc: 0.0121 - ETA: 108s - loss: 4.8462 - acc: 0.0121 - ETA: 107s - loss: 4.8458 - acc: 0.0120 - ETA: 106s - loss: 4.8451 - acc: 0.0120 - ETA: 105s - loss: 4.8450 - acc: 0.0121 - ETA: 104s - loss: 4.8446 - acc: 0.0126 - ETA: 103s - loss: 4.8440 - acc: 0.0125 - ETA: 102s - loss: 4.8451 - acc: 0.0124 - ETA: 102s - loss: 4.8452 - acc: 0.0124 - ETA: 101s - loss: 4.8456 - acc: 0.0123 - ETA: 100s - loss: 4.8456 - acc: 0.0123 - ETA: 99s - loss: 4.8455 - acc: 0.0122  - ETA: 98s - loss: 4.8456 - acc: 0.0122 - ETA: 97s - loss: 4.8453 - acc: 0.0123 - ETA: 96s - loss: 4.8451 - acc: 0.0125 - ETA: 95s - loss: 4.8448 - acc: 0.0127 - ETA: 94s - loss: 4.8443 - acc: 0.0128 - ETA: 94s - loss: 4.8443 - acc: 0.0128 - ETA: 93s - loss: 4.8443 - acc: 0.0127 - ETA: 92s - loss: 4.8445 - acc: 0.0127 - ETA: 91s - loss: 4.8449 - acc: 0.0126 - ETA: 90s - loss: 4.8445 - acc: 0.0128 - ETA: 89s - loss: 4.8442 - acc: 0.0129 - ETA: 88s - loss: 4.8440 - acc: 0.0129 - ETA: 87s - loss: 4.8440 - acc: 0.0128 - ETA: 87s - loss: 4.8442 - acc: 0.0128 - ETA: 86s - loss: 4.8448 - acc: 0.0127 - ETA: 85s - loss: 4.8450 - acc: 0.0127 - ETA: 84s - loss: 4.8446 - acc: 0.0126 - ETA: 83s - loss: 4.8439 - acc: 0.0126 - ETA: 82s - loss: 4.8435 - acc: 0.0127 - ETA: 81s - loss: 4.8433 - acc: 0.0127 - ETA: 80s - loss: 4.8433 - acc: 0.0126 - ETA: 79s - loss: 4.8432 - acc: 0.0126 - ETA: 79s - loss: 4.8436 - acc: 0.0125 - ETA: 78s - loss: 4.8438 - acc: 0.0124 - ETA: 77s - loss: 4.8439 - acc: 0.0124 - ETA: 76s - loss: 4.8443 - acc: 0.0123 - ETA: 75s - loss: 4.8442 - acc: 0.0123 - ETA: 74s - loss: 4.8439 - acc: 0.0124 - ETA: 73s - loss: 4.8438 - acc: 0.0124 - ETA: 72s - loss: 4.8440 - acc: 0.0124 - ETA: 72s - loss: 4.8440 - acc: 0.0123 - ETA: 71s - loss: 4.8437 - acc: 0.0123 - ETA: 70s - loss: 4.8442 - acc: 0.0122 - ETA: 69s - loss: 4.8439 - acc: 0.0125 - ETA: 68s - loss: 4.8442 - acc: 0.0125 - ETA: 67s - loss: 4.8445 - acc: 0.0125 - ETA: 66s - loss: 4.8445 - acc: 0.0124 - ETA: 65s - loss: 4.8447 - acc: 0.0124 - ETA: 64s - loss: 4.8444 - acc: 0.0123 - ETA: 64s - loss: 4.8447 - acc: 0.0123 - ETA: 63s - loss: 4.8446 - acc: 0.0122 - ETA: 62s - loss: 4.8446 - acc: 0.0122 - ETA: 61s - loss: 4.8442 - acc: 0.0121 - ETA: 60s - loss: 4.8440 - acc: 0.0121 - ETA: 59s - loss: 4.8438 - acc: 0.0120 - ETA: 58s - loss: 4.8439 - acc: 0.0120 - ETA: 58s - loss: 4.8439 - acc: 0.0119 - ETA: 57s - loss: 4.8443 - acc: 0.0119 - ETA: 56s - loss: 4.8440 - acc: 0.0120 - ETA: 55s - loss: 4.8443 - acc: 0.0120 - ETA: 54s - loss: 4.8438 - acc: 0.0119 - ETA: 53s - loss: 4.8438 - acc: 0.0119 - ETA: 52s - loss: 4.8435 - acc: 0.0120 - ETA: 51s - loss: 4.8428 - acc: 0.0122 - ETA: 51s - loss: 4.8428 - acc: 0.0121 - ETA: 50s - loss: 4.8427 - acc: 0.0123 - ETA: 49s - loss: 4.8428 - acc: 0.0122 - ETA: 48s - loss: 4.8430 - acc: 0.0122 - ETA: 47s - loss: 4.8430 - acc: 0.0121 - ETA: 46s - loss: 4.8430 - acc: 0.0121 - ETA: 45s - loss: 4.8430 - acc: 0.0121 - ETA: 44s - loss: 4.8435 - acc: 0.0120 - ETA: 44s - loss: 4.8430 - acc: 0.0120 - ETA: 43s - loss: 4.8427 - acc: 0.0119 - ETA: 42s - loss: 4.8429 - acc: 0.0121 - ETA: 41s - loss: 4.8425 - acc: 0.0120 - ETA: 40s - loss: 4.8422 - acc: 0.0120 - ETA: 39s - loss: 4.8424 - acc: 0.0119 - ETA: 38s - loss: 4.8420 - acc: 0.0119 - ETA: 37s - loss: 4.8415 - acc: 0.0119 - ETA: 37s - loss: 4.8415 - acc: 0.0118 - ETA: 36s - loss: 4.8416 - acc: 0.0118 - ETA: 35s - loss: 4.8413 - acc: 0.0119 - ETA: 34s - loss: 4.8416 - acc: 0.0119 - ETA: 33s - loss: 4.8413 - acc: 0.0120 - ETA: 32s - loss: 4.8410 - acc: 0.0120 - ETA: 31s - loss: 4.8406 - acc: 0.0121 - ETA: 31s - loss: 4.8410 - acc: 0.0120 - ETA: 30s - loss: 4.8410 - acc: 0.0120 - ETA: 29s - loss: 4.8405 - acc: 0.0121 - ETA: 28s - loss: 4.8404 - acc: 0.0121 - ETA: 27s - loss: 4.8404 - acc: 0.0120 - ETA: 26s - loss: 4.8403 - acc: 0.0122 - ETA: 25s - loss: 4.8403 - acc: 0.0121 - ETA: 24s - loss: 4.8404 - acc: 0.0121 - ETA: 23s - loss: 4.8408 - acc: 0.0121 - ETA: 23s - loss: 4.8410 - acc: 0.0120 - ETA: 22s - loss: 4.8408 - acc: 0.0123 - ETA: 21s - loss: 4.8409 - acc: 0.0123 - ETA: 20s - loss: 4.8408 - acc: 0.0124 - ETA: 19s - loss: 4.8411 - acc: 0.0123 - ETA: 18s - loss: 4.8415 - acc: 0.0123 - ETA: 17s - loss: 4.8415 - acc: 0.0123 - ETA: 16s - loss: 4.8415 - acc: 0.0122 - ETA: 15s - loss: 4.8412 - acc: 0.0122 - ETA: 15s - loss: 4.8411 - acc: 0.0121 - ETA: 14s - loss: 4.8413 - acc: 0.0121 - ETA: 13s - loss: 4.8410 - acc: 0.0122 - ETA: 12s - loss: 4.8409 - acc: 0.0122 - ETA: 11s - loss: 4.8407 - acc: 0.0121 - ETA: 10s - loss: 4.8415 - acc: 0.0121 - ETA: 9s - loss: 4.8413 - acc: 0.0122  - ETA: 8s - loss: 4.8411 - acc: 0.0122 - ETA: 7s - loss: 4.8408 - acc: 0.0122 - ETA: 7s - loss: 4.8406 - acc: 0.0124 - ETA: 6s - loss: 4.8403 - acc: 0.0127 - ETA: 5s - loss: 4.8403 - acc: 0.0127 - ETA: 4s - loss: 4.8403 - acc: 0.0126 - ETA: 3s - loss: 4.8403 - acc: 0.0127 - ETA: 2s - loss: 4.8401 - acc: 0.0127 - ETA: 1s - loss: 4.8399 - acc: 0.0127 - ETA: 0s - loss: 4.8400 - acc: 0.0128Epoch 00001: val_loss improved from 4.85772 to 4.82232, saving model to saved_models/weights.best.from_scratch.hdf5
    6680/6680 [==============================] - 310s - loss: 4.8397 - acc: 0.0127 - val_loss: 4.8223 - val_acc: 0.0192
    Epoch 3/5
    6660/6680 [============================>.] - ETA: 296s - loss: 4.7613 - acc: 0.0500 - ETA: 285s - loss: 4.7012 - acc: 0.1000 - ETA: 285s - loss: 4.7273 - acc: 0.0667 - ETA: 281s - loss: 4.7717 - acc: 0.0500 - ETA: 282s - loss: 4.7880 - acc: 0.0400 - ETA: 283s - loss: 4.7791 - acc: 0.0333 - ETA: 282s - loss: 4.7790 - acc: 0.0286 - ETA: 283s - loss: 4.7868 - acc: 0.0250 - ETA: 283s - loss: 4.7937 - acc: 0.0333 - ETA: 282s - loss: 4.7935 - acc: 0.0300 - ETA: 281s - loss: 4.8033 - acc: 0.0273 - ETA: 280s - loss: 4.8002 - acc: 0.0292 - ETA: 279s - loss: 4.7960 - acc: 0.0269 - ETA: 278s - loss: 4.8021 - acc: 0.0250 - ETA: 277s - loss: 4.7956 - acc: 0.0233 - ETA: 276s - loss: 4.7978 - acc: 0.0219 - ETA: 277s - loss: 4.7916 - acc: 0.0206 - ETA: 277s - loss: 4.7879 - acc: 0.0222 - ETA: 280s - loss: 4.7883 - acc: 0.0211 - ETA: 281s - loss: 4.7888 - acc: 0.0200 - ETA: 280s - loss: 4.7876 - acc: 0.0190 - ETA: 280s - loss: 4.7907 - acc: 0.0182 - ETA: 279s - loss: 4.7920 - acc: 0.0174 - ETA: 278s - loss: 4.7893 - acc: 0.0167 - ETA: 278s - loss: 4.7877 - acc: 0.0180 - ETA: 278s - loss: 4.7867 - acc: 0.0192 - ETA: 277s - loss: 4.7886 - acc: 0.0204 - ETA: 276s - loss: 4.7872 - acc: 0.0214 - ETA: 276s - loss: 4.7836 - acc: 0.0224 - ETA: 275s - loss: 4.7836 - acc: 0.0217 - ETA: 274s - loss: 4.7798 - acc: 0.0210 - ETA: 274s - loss: 4.7853 - acc: 0.0219 - ETA: 273s - loss: 4.7843 - acc: 0.0227 - ETA: 272s - loss: 4.7816 - acc: 0.0221 - ETA: 271s - loss: 4.7788 - acc: 0.0214 - ETA: 270s - loss: 4.7864 - acc: 0.0208 - ETA: 269s - loss: 4.7854 - acc: 0.0230 - ETA: 268s - loss: 4.7892 - acc: 0.0224 - ETA: 268s - loss: 4.7885 - acc: 0.0218 - ETA: 267s - loss: 4.7903 - acc: 0.0213 - ETA: 266s - loss: 4.7930 - acc: 0.0207 - ETA: 265s - loss: 4.7967 - acc: 0.0202 - ETA: 264s - loss: 4.7959 - acc: 0.0198 - ETA: 263s - loss: 4.7973 - acc: 0.0193 - ETA: 262s - loss: 4.7980 - acc: 0.0189 - ETA: 261s - loss: 4.7963 - acc: 0.0185 - ETA: 260s - loss: 4.7969 - acc: 0.0181 - ETA: 259s - loss: 4.7988 - acc: 0.0198 - ETA: 258s - loss: 4.7998 - acc: 0.0194 - ETA: 257s - loss: 4.8001 - acc: 0.0190 - ETA: 256s - loss: 4.7990 - acc: 0.0196 - ETA: 255s - loss: 4.7985 - acc: 0.0192 - ETA: 254s - loss: 4.7994 - acc: 0.0189 - ETA: 254s - loss: 4.8006 - acc: 0.0194 - ETA: 253s - loss: 4.7975 - acc: 0.0191 - ETA: 252s - loss: 4.7969 - acc: 0.0188 - ETA: 251s - loss: 4.7992 - acc: 0.0184 - ETA: 250s - loss: 4.7981 - acc: 0.0181 - ETA: 249s - loss: 4.8000 - acc: 0.0178 - ETA: 248s - loss: 4.7990 - acc: 0.0175 - ETA: 246s - loss: 4.7980 - acc: 0.0180 - ETA: 245s - loss: 4.7987 - acc: 0.0177 - ETA: 244s - loss: 4.8010 - acc: 0.0175 - ETA: 243s - loss: 4.8013 - acc: 0.0172 - ETA: 242s - loss: 4.8023 - acc: 0.0169 - ETA: 242s - loss: 4.8035 - acc: 0.0167 - ETA: 241s - loss: 4.8029 - acc: 0.0172 - ETA: 240s - loss: 4.8012 - acc: 0.0169 - ETA: 239s - loss: 4.8023 - acc: 0.0167 - ETA: 238s - loss: 4.8034 - acc: 0.0164 - ETA: 237s - loss: 4.8020 - acc: 0.0162 - ETA: 237s - loss: 4.8025 - acc: 0.0160 - ETA: 236s - loss: 4.8022 - acc: 0.0164 - ETA: 236s - loss: 4.8025 - acc: 0.0169 - ETA: 235s - loss: 4.8024 - acc: 0.0167 - ETA: 235s - loss: 4.8016 - acc: 0.0164 - ETA: 234s - loss: 4.7997 - acc: 0.0169 - ETA: 234s - loss: 4.7993 - acc: 0.0167 - ETA: 233s - loss: 4.8007 - acc: 0.0165 - ETA: 232s - loss: 4.8014 - acc: 0.0163 - ETA: 231s - loss: 4.8027 - acc: 0.0160 - ETA: 231s - loss: 4.8012 - acc: 0.0159 - ETA: 230s - loss: 4.8007 - acc: 0.0157 - ETA: 229s - loss: 4.8005 - acc: 0.0155 - ETA: 228s - loss: 4.8014 - acc: 0.0153 - ETA: 228s - loss: 4.8021 - acc: 0.0151 - ETA: 227s - loss: 4.8012 - acc: 0.0155 - ETA: 227s - loss: 4.8004 - acc: 0.0159 - ETA: 226s - loss: 4.8028 - acc: 0.0157 - ETA: 225s - loss: 4.8029 - acc: 0.0161 - ETA: 224s - loss: 4.8016 - acc: 0.0159 - ETA: 223s - loss: 4.8016 - acc: 0.0158 - ETA: 222s - loss: 4.8009 - acc: 0.0161 - ETA: 221s - loss: 4.7998 - acc: 0.0170 - ETA: 220s - loss: 4.7979 - acc: 0.0168 - ETA: 219s - loss: 4.7982 - acc: 0.0167 - ETA: 218s - loss: 4.7973 - acc: 0.0165 - ETA: 217s - loss: 4.7976 - acc: 0.0163 - ETA: 216s - loss: 4.7993 - acc: 0.0172 - ETA: 215s - loss: 4.7986 - acc: 0.0170 - ETA: 214s - loss: 4.7961 - acc: 0.0178 - ETA: 213s - loss: 4.7943 - acc: 0.0181 - ETA: 212s - loss: 4.7944 - acc: 0.0184 - ETA: 211s - loss: 4.7958 - acc: 0.0183 - ETA: 210s - loss: 4.7953 - acc: 0.0186 - ETA: 209s - loss: 4.7965 - acc: 0.0184 - ETA: 208s - loss: 4.7964 - acc: 0.0187 - ETA: 207s - loss: 4.7957 - acc: 0.0185 - ETA: 206s - loss: 4.7970 - acc: 0.0183 - ETA: 205s - loss: 4.7990 - acc: 0.0186 - ETA: 204s - loss: 4.7990 - acc: 0.0185 - ETA: 203s - loss: 4.7990 - acc: 0.0188 - ETA: 202s - loss: 4.7972 - acc: 0.0186 - ETA: 201s - loss: 4.7963 - acc: 0.0189 - ETA: 200s - loss: 4.7973 - acc: 0.0187 - ETA: 199s - loss: 4.7980 - acc: 0.0185 - ETA: 198s - loss: 4.7987 - acc: 0.0184 - ETA: 197s - loss: 4.7981 - acc: 0.0182 - ETA: 196s - loss: 4.7983 - acc: 0.0185 - ETA: 195s - loss: 4.7982 - acc: 0.0183 - ETA: 194s - loss: 4.7979 - acc: 0.0182 - ETA: 193s - loss: 4.7976 - acc: 0.0184 - ETA: 192s - loss: 4.7977 - acc: 0.0183 - ETA: 191s - loss: 4.7973 - acc: 0.0190 - ETA: 190s - loss: 4.7968 - acc: 0.0192 - ETA: 189s - loss: 4.7966 - acc: 0.0194 - ETA: 188s - loss: 4.7962 - acc: 0.0197 - ETA: 187s - loss: 4.7941 - acc: 0.0199 - ETA: 186s - loss: 4.7941 - acc: 0.0198 - ETA: 185s - loss: 4.7944 - acc: 0.0196 - ETA: 184s - loss: 4.7939 - acc: 0.0198 - ETA: 183s - loss: 4.7943 - acc: 0.0201 - ETA: 182s - loss: 4.7952 - acc: 0.0203 - ETA: 181s - loss: 4.7955 - acc: 0.0205 - ETA: 181s - loss: 4.7960 - acc: 0.0204 - ETA: 180s - loss: 4.7960 - acc: 0.0202 - ETA: 179s - loss: 4.7965 - acc: 0.0201 - ETA: 178s - loss: 4.7966 - acc: 0.0203 - ETA: 177s - loss: 4.7968 - acc: 0.0201 - ETA: 176s - loss: 4.7976 - acc: 0.0204 - ETA: 175s - loss: 4.7983 - acc: 0.0206 - ETA: 174s - loss: 4.7973 - acc: 0.0204 - ETA: 173s - loss: 4.7965 - acc: 0.0203 - ETA: 172s - loss: 4.7974 - acc: 0.0201 - ETA: 171s - loss: 4.7971 - acc: 0.0200 - ETA: 170s - loss: 4.7972 - acc: 0.0199 - ETA: 169s - loss: 4.7971 - acc: 0.0197 - ETA: 168s - loss: 4.7969 - acc: 0.0203 - ETA: 167s - loss: 4.7965 - acc: 0.0205 - ETA: 166s - loss: 4.7958 - acc: 0.0203 - ETA: 165s - loss: 4.7957 - acc: 0.0202 - ETA: 165s - loss: 4.7956 - acc: 0.0204 - ETA: 164s - loss: 4.7958 - acc: 0.0203 - ETA: 163s - loss: 4.7948 - acc: 0.0208 - ETA: 162s - loss: 4.7953 - acc: 0.0206 - ETA: 161s - loss: 4.7951 - acc: 0.0205 - ETA: 160s - loss: 4.7954 - acc: 0.0210 - ETA: 159s - loss: 4.7963 - acc: 0.0209 - ETA: 159s - loss: 4.7957 - acc: 0.0208 - ETA: 158s - loss: 4.7949 - acc: 0.0206 - ETA: 157s - loss: 4.7950 - acc: 0.0205 - ETA: 156s - loss: 4.7961 - acc: 0.0204 - ETA: 155s - loss: 4.7957 - acc: 0.0209 - ETA: 154s - loss: 4.7958 - acc: 0.0207 - ETA: 153s - loss: 4.7952 - acc: 0.0206 - ETA: 152s - loss: 4.7953 - acc: 0.0205 - ETA: 151s - loss: 4.7948 - acc: 0.0204 - ETA: 150s - loss: 4.7956 - acc: 0.0205 - ETA: 149s - loss: 4.7956 - acc: 0.0204 - ETA: 148s - loss: 4.7948 - acc: 0.0206 - ETA: 147s - loss: 4.7951 - acc: 0.0205 - ETA: 146s - loss: 4.7948 - acc: 0.0209 - ETA: 145s - loss: 4.7950 - acc: 0.0208 - ETA: 145s - loss: 4.7947 - acc: 0.0207 - ETA: 144s - loss: 4.7949 - acc: 0.0209 - ETA: 143s - loss: 4.7945 - acc: 0.0207 - ETA: 142s - loss: 4.7944 - acc: 0.0209 - ETA: 141s - loss: 4.7943 - acc: 0.0208 - ETA: 140s - loss: 4.7952 - acc: 0.0207 - ETA: 139s - loss: 4.7958 - acc: 0.0206 - ETA: 138s - loss: 4.7966 - acc: 0.0204 - ETA: 137s - loss: 4.7960 - acc: 0.0206 - ETA: 136s - loss: 4.7957 - acc: 0.0205 - ETA: 135s - loss: 4.7958 - acc: 0.0204 - ETA: 134s - loss: 4.7959 - acc: 0.0203 - ETA: 133s - loss: 4.7954 - acc: 0.0202 - ETA: 133s - loss: 4.7955 - acc: 0.0201 - ETA: 132s - loss: 4.7960 - acc: 0.0199 - ETA: 131s - loss: 4.7965 - acc: 0.0198 - ETA: 130s - loss: 4.7967 - acc: 0.0197 - ETA: 129s - loss: 4.7960 - acc: 0.0199 - ETA: 128s - loss: 4.7961 - acc: 0.0198 - ETA: 127s - loss: 4.7979 - acc: 0.0197 - ETA: 126s - loss: 4.7982 - acc: 0.0196 - ETA: 125s - loss: 4.7973 - acc: 0.0197 - ETA: 124s - loss: 4.7976 - acc: 0.0196 - ETA: 123s - loss: 4.7982 - acc: 0.0195 - ETA: 123s - loss: 4.7984 - acc: 0.0194 - ETA: 122s - loss: 4.7983 - acc: 0.0193 - ETA: 121s - loss: 4.7976 - acc: 0.0198 - ETA: 120s - loss: 4.7981 - acc: 0.0197 - ETA: 119s - loss: 4.7982 - acc: 0.0196 - ETA: 118s - loss: 4.7983 - acc: 0.0195 - ETA: 117s - loss: 4.7980 - acc: 0.0194 - ETA: 116s - loss: 4.7987 - acc: 0.0193 - ETA: 116s - loss: 4.7986 - acc: 0.0192 - ETA: 115s - loss: 4.7988 - acc: 0.0191 - ETA: 114s - loss: 4.7986 - acc: 0.0190 - ETA: 113s - loss: 4.7985 - acc: 0.0189 - ETA: 112s - loss: 4.7981 - acc: 0.0188 - ETA: 111s - loss: 4.7974 - acc: 0.0190 - ETA: 111s - loss: 4.7976 - acc: 0.0189 - ETA: 110s - loss: 4.7978 - acc: 0.0188 - ETA: 109s - loss: 4.7975 - acc: 0.0187 - ETA: 108s - loss: 4.7977 - acc: 0.0186 - ETA: 107s - loss: 4.7976 - acc: 0.0188 - ETA: 106s - loss: 4.7975 - acc: 0.0189 - ETA: 105s - loss: 4.7972 - acc: 0.0188 - ETA: 104s - loss: 4.7974 - acc: 0.0189 - ETA: 103s - loss: 4.7973 - acc: 0.0189 - ETA: 103s - loss: 4.7978 - acc: 0.0188 - ETA: 102s - loss: 4.7979 - acc: 0.0191 - ETA: 101s - loss: 4.7983 - acc: 0.0191 - ETA: 100s - loss: 4.7977 - acc: 0.0190 - ETA: 99s - loss: 4.7978 - acc: 0.0191  - ETA: 98s - loss: 4.7982 - acc: 0.0190 - ETA: 97s - loss: 4.7987 - acc: 0.0189 - ETA: 96s - loss: 4.7983 - acc: 0.0189 - ETA: 95s - loss: 4.7987 - acc: 0.0188 - ETA: 95s - loss: 4.7986 - acc: 0.0187 - ETA: 94s - loss: 4.7979 - acc: 0.0186 - ETA: 93s - loss: 4.7989 - acc: 0.0188 - ETA: 92s - loss: 4.7986 - acc: 0.0189 - ETA: 91s - loss: 4.7983 - acc: 0.0190 - ETA: 90s - loss: 4.7978 - acc: 0.0189 - ETA: 89s - loss: 4.7970 - acc: 0.0189 - ETA: 88s - loss: 4.7974 - acc: 0.0190 - ETA: 87s - loss: 4.7974 - acc: 0.0191 - ETA: 86s - loss: 4.7974 - acc: 0.0190 - ETA: 85s - loss: 4.7967 - acc: 0.0192 - ETA: 85s - loss: 4.7969 - acc: 0.0191 - ETA: 84s - loss: 4.7970 - acc: 0.0190 - ETA: 83s - loss: 4.7968 - acc: 0.0189 - ETA: 82s - loss: 4.7966 - acc: 0.0189 - ETA: 81s - loss: 4.7971 - acc: 0.0188 - ETA: 80s - loss: 4.7968 - acc: 0.0189 - ETA: 79s - loss: 4.7963 - acc: 0.0188 - ETA: 78s - loss: 4.7969 - acc: 0.0190 - ETA: 77s - loss: 4.7978 - acc: 0.0189 - ETA: 76s - loss: 4.7970 - acc: 0.0188 - ETA: 75s - loss: 4.7972 - acc: 0.0187 - ETA: 74s - loss: 4.7971 - acc: 0.0187 - ETA: 74s - loss: 4.7965 - acc: 0.0186 - ETA: 73s - loss: 4.7960 - acc: 0.0185 - ETA: 72s - loss: 4.7964 - acc: 0.0184 - ETA: 71s - loss: 4.7965 - acc: 0.0184 - ETA: 70s - loss: 4.7970 - acc: 0.0183 - ETA: 69s - loss: 4.7969 - acc: 0.0184 - ETA: 68s - loss: 4.7970 - acc: 0.0183 - ETA: 67s - loss: 4.7969 - acc: 0.0183 - ETA: 66s - loss: 4.7971 - acc: 0.0182 - ETA: 66s - loss: 4.7967 - acc: 0.0183 - ETA: 65s - loss: 4.7967 - acc: 0.0183 - ETA: 64s - loss: 4.7964 - acc: 0.0184 - ETA: 63s - loss: 4.7964 - acc: 0.0183 - ETA: 62s - loss: 4.7966 - acc: 0.0182 - ETA: 61s - loss: 4.7961 - acc: 0.0182 - ETA: 60s - loss: 4.7964 - acc: 0.0181 - ETA: 59s - loss: 4.7956 - acc: 0.0182 - ETA: 58s - loss: 4.7953 - acc: 0.0181 - ETA: 58s - loss: 4.7952 - acc: 0.0181 - ETA: 57s - loss: 4.7956 - acc: 0.0182 - ETA: 56s - loss: 4.7959 - acc: 0.0181 - ETA: 55s - loss: 4.7964 - acc: 0.0181 - ETA: 54s - loss: 4.7960 - acc: 0.0180 - ETA: 53s - loss: 4.7958 - acc: 0.0179 - ETA: 52s - loss: 4.7960 - acc: 0.0182 - ETA: 51s - loss: 4.7962 - acc: 0.0185 - ETA: 50s - loss: 4.7959 - acc: 0.0185 - ETA: 49s - loss: 4.7957 - acc: 0.0184 - ETA: 48s - loss: 4.7953 - acc: 0.0183 - ETA: 48s - loss: 4.7952 - acc: 0.0183 - ETA: 47s - loss: 4.7954 - acc: 0.0182 - ETA: 46s - loss: 4.7953 - acc: 0.0181 - ETA: 45s - loss: 4.7955 - acc: 0.0181 - ETA: 44s - loss: 4.7947 - acc: 0.0180 - ETA: 43s - loss: 4.7946 - acc: 0.0179 - ETA: 42s - loss: 4.7948 - acc: 0.0179 - ETA: 41s - loss: 4.7953 - acc: 0.0178 - ETA: 208s - loss: 4.7954 - acc: 0.0178 - ETA: 203s - loss: 4.7951 - acc: 0.0177 - ETA: 198s - loss: 4.7948 - acc: 0.0176 - ETA: 192s - loss: 4.7947 - acc: 0.0176 - ETA: 187s - loss: 4.7941 - acc: 0.0175 - ETA: 182s - loss: 4.7935 - acc: 0.0175 - ETA: 177s - loss: 4.7935 - acc: 0.0174 - ETA: 172s - loss: 4.7933 - acc: 0.0175 - ETA: 167s - loss: 4.7937 - acc: 0.0174 - ETA: 162s - loss: 4.7935 - acc: 0.0174 - ETA: 157s - loss: 4.7934 - acc: 0.0175 - ETA: 152s - loss: 4.7930 - acc: 0.0174 - ETA: 147s - loss: 4.7934 - acc: 0.0174 - ETA: 142s - loss: 4.7934 - acc: 0.0175 - ETA: 137s - loss: 4.7941 - acc: 0.0176 - ETA: 132s - loss: 4.7943 - acc: 0.0175 - ETA: 127s - loss: 4.7942 - acc: 0.0175 - ETA: 122s - loss: 4.7939 - acc: 0.0174 - ETA: 117s - loss: 4.7942 - acc: 0.0177 - ETA: 113s - loss: 4.7945 - acc: 0.0178 - ETA: 108s - loss: 4.7939 - acc: 0.0177 - ETA: 103s - loss: 4.7935 - acc: 0.0180 - ETA: 98s - loss: 4.7937 - acc: 0.0179  - ETA: 94s - loss: 4.7936 - acc: 0.0179 - ETA: 89s - loss: 4.7941 - acc: 0.0178 - ETA: 84s - loss: 4.7942 - acc: 0.0179 - ETA: 80s - loss: 4.7942 - acc: 0.0180 - ETA: 75s - loss: 4.7939 - acc: 0.0180 - ETA: 70s - loss: 4.7938 - acc: 0.0179 - ETA: 66s - loss: 4.7935 - acc: 0.0179 - ETA: 61s - loss: 4.7927 - acc: 0.0181 - ETA: 57s - loss: 4.7930 - acc: 0.0181 - ETA: 52s - loss: 4.7929 - acc: 0.0180 - ETA: 48s - loss: 4.7932 - acc: 0.0180 - ETA: 43s - loss: 4.7937 - acc: 0.0179 - ETA: 39s - loss: 4.7934 - acc: 0.0180 - ETA: 34s - loss: 4.7933 - acc: 0.0179 - ETA: 30s - loss: 4.7934 - acc: 0.0180 - ETA: 25s - loss: 4.7933 - acc: 0.0181 - ETA: 21s - loss: 4.7929 - acc: 0.0184 - ETA: 17s - loss: 4.7928 - acc: 0.0185 - ETA: 12s - loss: 4.7931 - acc: 0.0184 - ETA: 8s - loss: 4.7933 - acc: 0.0185  - ETA: 4s - loss: 4.7932 - acc: 0.0185Epoch 00002: val_loss improved from 4.82232 to 4.78935, saving model to saved_models/weights.best.from_scratch.hdf5
    6680/6680 [==============================] - 1444s - loss: 4.7931 - acc: 0.0184 - val_loss: 4.7894 - val_acc: 0.0192
    Epoch 4/5
    6660/6680 [============================>.] - ETA: 379s - loss: 4.8176 - acc: 0.0000e+00 - ETA: 363s - loss: 4.7642 - acc: 0.0000e+00 - ETA: 363s - loss: 4.7572 - acc: 0.0000e+00 - ETA: 364s - loss: 4.7724 - acc: 0.0000e+00 - ETA: 370s - loss: 4.8065 - acc: 0.0000e+00 - ETA: 370s - loss: 4.8030 - acc: 0.0000e+00 - ETA: 372s - loss: 4.8062 - acc: 0.0000e+00 - ETA: 368s - loss: 4.8115 - acc: 0.0063     - ETA: 367s - loss: 4.8079 - acc: 0.0056 - ETA: 365s - loss: 4.7952 - acc: 0.0100 - ETA: 362s - loss: 4.7906 - acc: 0.0091 - ETA: 362s - loss: 4.7841 - acc: 0.0083 - ETA: 361s - loss: 4.7910 - acc: 0.0154 - ETA: 362s - loss: 4.7861 - acc: 0.0179 - ETA: 363s - loss: 4.7881 - acc: 0.0167 - ETA: 363s - loss: 4.7693 - acc: 0.0281 - ETA: 359s - loss: 4.7804 - acc: 0.0265 - ETA: 357s - loss: 4.7811 - acc: 0.0278 - ETA: 355s - loss: 4.7758 - acc: 0.0289 - ETA: 353s - loss: 4.7804 - acc: 0.0275 - ETA: 351s - loss: 4.7763 - acc: 0.0262 - ETA: 349s - loss: 4.7834 - acc: 0.0250 - ETA: 347s - loss: 4.7846 - acc: 0.0261 - ETA: 345s - loss: 4.7849 - acc: 0.0250 - ETA: 343s - loss: 4.7823 - acc: 0.0240 - ETA: 341s - loss: 4.7795 - acc: 0.0231 - ETA: 339s - loss: 4.7843 - acc: 0.0259 - ETA: 338s - loss: 4.7852 - acc: 0.0268 - ETA: 338s - loss: 4.7841 - acc: 0.0259 - ETA: 337s - loss: 4.7840 - acc: 0.0250 - ETA: 336s - loss: 4.7782 - acc: 0.0258 - ETA: 335s - loss: 4.7773 - acc: 0.0266 - ETA: 334s - loss: 4.7785 - acc: 0.0258 - ETA: 333s - loss: 4.7786 - acc: 0.0265 - ETA: 331s - loss: 4.7796 - acc: 0.0257 - ETA: 331s - loss: 4.7786 - acc: 0.0264 - ETA: 330s - loss: 4.7817 - acc: 0.0257 - ETA: 329s - loss: 4.7821 - acc: 0.0250 - ETA: 328s - loss: 4.7847 - acc: 0.0256 - ETA: 327s - loss: 4.7829 - acc: 0.0263 - ETA: 326s - loss: 4.7849 - acc: 0.0256 - ETA: 325s - loss: 4.7829 - acc: 0.0250 - ETA: 323s - loss: 4.7813 - acc: 0.0244 - ETA: 323s - loss: 4.7801 - acc: 0.0239 - ETA: 321s - loss: 4.7786 - acc: 0.0233 - ETA: 320s - loss: 4.7783 - acc: 0.0228 - ETA: 319s - loss: 4.7787 - acc: 0.0223 - ETA: 318s - loss: 4.7792 - acc: 0.0219 - ETA: 317s - loss: 4.7798 - acc: 0.0214 - ETA: 315s - loss: 4.7780 - acc: 0.0210 - ETA: 314s - loss: 4.7807 - acc: 0.0225 - ETA: 313s - loss: 4.7785 - acc: 0.0221 - ETA: 312s - loss: 4.7768 - acc: 0.0217 - ETA: 311s - loss: 4.7780 - acc: 0.0213 - ETA: 310s - loss: 4.7790 - acc: 0.0209 - ETA: 309s - loss: 4.7789 - acc: 0.0205 - ETA: 308s - loss: 4.7782 - acc: 0.0202 - ETA: 307s - loss: 4.7811 - acc: 0.0198 - ETA: 306s - loss: 4.7809 - acc: 0.0212 - ETA: 305s - loss: 4.7813 - acc: 0.0208 - ETA: 304s - loss: 4.7810 - acc: 0.0205 - ETA: 303s - loss: 4.7798 - acc: 0.0210 - ETA: 302s - loss: 4.7808 - acc: 0.0214 - ETA: 301s - loss: 4.7785 - acc: 0.0219 - ETA: 300s - loss: 4.7766 - acc: 0.0215 - ETA: 299s - loss: 4.7765 - acc: 0.0212 - ETA: 297s - loss: 4.7743 - acc: 0.0216 - ETA: 296s - loss: 4.7765 - acc: 0.0213 - ETA: 295s - loss: 4.7771 - acc: 0.0210 - ETA: 294s - loss: 4.7777 - acc: 0.0207 - ETA: 292s - loss: 4.7782 - acc: 0.0204 - ETA: 291s - loss: 4.7769 - acc: 0.0201 - ETA: 290s - loss: 4.7762 - acc: 0.0205 - ETA: 289s - loss: 4.7757 - acc: 0.0203 - ETA: 288s - loss: 4.7732 - acc: 0.0200 - ETA: 286s - loss: 4.7727 - acc: 0.0204 - ETA: 285s - loss: 4.7746 - acc: 0.0201 - ETA: 284s - loss: 4.7761 - acc: 0.0199 - ETA: 283s - loss: 4.7753 - acc: 0.0196 - ETA: 282s - loss: 4.7772 - acc: 0.0194 - ETA: 281s - loss: 4.7773 - acc: 0.0191 - ETA: 280s - loss: 4.7756 - acc: 0.0195 - ETA: 278s - loss: 4.7747 - acc: 0.0193 - ETA: 277s - loss: 4.7734 - acc: 0.0190 - ETA: 276s - loss: 4.7741 - acc: 0.0194 - ETA: 274s - loss: 4.7732 - acc: 0.0198 - ETA: 273s - loss: 4.7723 - acc: 0.0195 - ETA: 272s - loss: 4.7727 - acc: 0.0193 - ETA: 270s - loss: 4.7723 - acc: 0.0197 - ETA: 269s - loss: 4.7717 - acc: 0.0194 - ETA: 268s - loss: 4.7728 - acc: 0.0198 - ETA: 267s - loss: 4.7724 - acc: 0.0201 - ETA: 265s - loss: 4.7720 - acc: 0.0199 - ETA: 264s - loss: 4.7727 - acc: 0.0197 - ETA: 263s - loss: 4.7734 - acc: 0.0195 - ETA: 261s - loss: 4.7742 - acc: 0.0198 - ETA: 260s - loss: 4.7738 - acc: 0.0196 - ETA: 259s - loss: 4.7743 - acc: 0.0194 - ETA: 257s - loss: 4.7759 - acc: 0.0192 - ETA: 256s - loss: 4.7745 - acc: 0.0190 - ETA: 255s - loss: 4.7732 - acc: 0.0193 - ETA: 253s - loss: 4.7737 - acc: 0.0191 - ETA: 252s - loss: 4.7711 - acc: 0.0194 - ETA: 250s - loss: 4.7702 - acc: 0.0192 - ETA: 249s - loss: 4.7701 - acc: 0.0190 - ETA: 248s - loss: 4.7717 - acc: 0.0189 - ETA: 247s - loss: 4.7689 - acc: 0.0187 - ETA: 245s - loss: 4.7668 - acc: 0.0190 - ETA: 244s - loss: 4.7665 - acc: 0.0188 - ETA: 242s - loss: 4.7656 - acc: 0.0186 - ETA: 241s - loss: 4.7652 - acc: 0.0189 - ETA: 240s - loss: 4.7643 - acc: 0.0188 - ETA: 238s - loss: 4.7649 - acc: 0.0186 - ETA: 237s - loss: 4.7642 - acc: 0.0189 - ETA: 236s - loss: 4.7645 - acc: 0.0187 - ETA: 235s - loss: 4.7631 - acc: 0.0190 - ETA: 233s - loss: 4.7623 - acc: 0.0188 - ETA: 232s - loss: 4.7631 - acc: 0.0186 - ETA: 231s - loss: 4.7639 - acc: 0.0185 - ETA: 229s - loss: 4.7628 - acc: 0.0192 - ETA: 228s - loss: 4.7634 - acc: 0.0190 - ETA: 227s - loss: 4.7616 - acc: 0.0193 - ETA: 226s - loss: 4.7619 - acc: 0.0191 - ETA: 224s - loss: 4.7621 - acc: 0.0190 - ETA: 223s - loss: 4.7638 - acc: 0.0188 - ETA: 222s - loss: 4.7658 - acc: 0.0187 - ETA: 221s - loss: 4.7672 - acc: 0.0185 - ETA: 219s - loss: 4.7659 - acc: 0.0184 - ETA: 218s - loss: 4.7652 - acc: 0.0186 - ETA: 217s - loss: 4.7653 - acc: 0.0188 - ETA: 216s - loss: 4.7648 - acc: 0.0195 - ETA: 214s - loss: 4.7651 - acc: 0.0193 - ETA: 213s - loss: 4.7650 - acc: 0.0192 - ETA: 212s - loss: 4.7649 - acc: 0.0194 - ETA: 211s - loss: 4.7644 - acc: 0.0193 - ETA: 209s - loss: 4.7654 - acc: 0.0191 - ETA: 208s - loss: 4.7656 - acc: 0.0190 - ETA: 207s - loss: 4.7657 - acc: 0.0188 - ETA: 206s - loss: 4.7651 - acc: 0.0191 - ETA: 205s - loss: 4.7660 - acc: 0.0189 - ETA: 203s - loss: 4.7651 - acc: 0.0188 - ETA: 202s - loss: 4.7638 - acc: 0.0187 - ETA: 201s - loss: 4.7628 - acc: 0.0189 - ETA: 200s - loss: 4.7625 - acc: 0.0191 - ETA: 199s - loss: 4.7617 - acc: 0.0193 - ETA: 197s - loss: 4.7621 - acc: 0.0192 - ETA: 196s - loss: 4.7622 - acc: 0.0190 - ETA: 195s - loss: 4.7619 - acc: 0.0193 - ETA: 194s - loss: 4.7624 - acc: 0.0191 - ETA: 193s - loss: 4.7624 - acc: 0.0190 - ETA: 192s - loss: 4.7618 - acc: 0.0189 - ETA: 190s - loss: 4.7611 - acc: 0.0188 - ETA: 189s - loss: 4.7608 - acc: 0.0186 - ETA: 188s - loss: 4.7607 - acc: 0.0188 - ETA: 187s - loss: 4.7608 - acc: 0.0187 - ETA: 186s - loss: 4.7609 - acc: 0.0186 - ETA: 185s - loss: 4.7602 - acc: 0.0188 - ETA: 184s - loss: 4.7599 - acc: 0.0187 - ETA: 182s - loss: 4.7585 - acc: 0.0186 - ETA: 181s - loss: 4.7592 - acc: 0.0184 - ETA: 180s - loss: 4.7569 - acc: 0.0186 - ETA: 179s - loss: 4.7570 - acc: 0.0185 - ETA: 178s - loss: 4.7565 - acc: 0.0184 - ETA: 177s - loss: 4.7577 - acc: 0.0186 - ETA: 176s - loss: 4.7577 - acc: 0.0188 - ETA: 175s - loss: 4.7585 - acc: 0.0187 - ETA: 174s - loss: 4.7605 - acc: 0.0186 - ETA: 173s - loss: 4.7604 - acc: 0.0185 - ETA: 171s - loss: 4.7605 - acc: 0.0183 - ETA: 170s - loss: 4.7602 - acc: 0.0182 - ETA: 169s - loss: 4.7596 - acc: 0.0184 - ETA: 168s - loss: 4.7608 - acc: 0.0183 - ETA: 167s - loss: 4.7602 - acc: 0.0182 - ETA: 166s - loss: 4.7611 - acc: 0.0181 - ETA: 165s - loss: 4.7612 - acc: 0.0180 - ETA: 164s - loss: 4.7616 - acc: 0.0179 - ETA: 163s - loss: 4.7617 - acc: 0.0181 - ETA: 161s - loss: 4.7616 - acc: 0.0180 - ETA: 160s - loss: 4.7614 - acc: 0.0179 - ETA: 159s - loss: 4.7604 - acc: 0.0178 - ETA: 158s - loss: 4.7590 - acc: 0.0180 - ETA: 157s - loss: 4.7594 - acc: 0.0179 - ETA: 156s - loss: 4.7600 - acc: 0.0180 - ETA: 155s - loss: 4.7590 - acc: 0.0179 - ETA: 154s - loss: 4.7586 - acc: 0.0178 - ETA: 153s - loss: 4.7586 - acc: 0.0177 - ETA: 151s - loss: 4.7585 - acc: 0.0179 - ETA: 150s - loss: 4.7584 - acc: 0.0178 - ETA: 149s - loss: 4.7584 - acc: 0.0177 - ETA: 148s - loss: 4.7593 - acc: 0.0176 - ETA: 147s - loss: 4.7595 - acc: 0.0175 - ETA: 146s - loss: 4.7596 - acc: 0.0177 - ETA: 145s - loss: 4.7600 - acc: 0.0176 - ETA: 144s - loss: 4.7603 - acc: 0.0175 - ETA: 143s - loss: 4.7599 - acc: 0.0177 - ETA: 142s - loss: 4.7613 - acc: 0.0176 - ETA: 141s - loss: 4.7611 - acc: 0.0175 - ETA: 140s - loss: 4.7608 - acc: 0.0177 - ETA: 138s - loss: 4.7609 - acc: 0.0176 - ETA: 137s - loss: 4.7604 - acc: 0.0175 - ETA: 136s - loss: 4.7603 - acc: 0.0177 - ETA: 135s - loss: 4.7597 - acc: 0.0181 - ETA: 134s - loss: 4.7598 - acc: 0.0182 - ETA: 133s - loss: 4.7593 - acc: 0.0184 - ETA: 132s - loss: 4.7607 - acc: 0.0183 - ETA: 131s - loss: 4.7606 - acc: 0.0184 - ETA: 130s - loss: 4.7606 - acc: 0.0191 - ETA: 129s - loss: 4.7608 - acc: 0.0190 - ETA: 128s - loss: 4.7620 - acc: 0.0189 - ETA: 127s - loss: 4.7626 - acc: 0.0190 - ETA: 126s - loss: 4.7626 - acc: 0.0194 - ETA: 125s - loss: 4.7627 - acc: 0.0193 - ETA: 124s - loss: 4.7627 - acc: 0.0195 - ETA: 123s - loss: 4.7626 - acc: 0.0196 - ETA: 122s - loss: 4.7625 - acc: 0.0198 - ETA: 120s - loss: 4.7626 - acc: 0.0199 - ETA: 119s - loss: 4.7627 - acc: 0.0198 - ETA: 118s - loss: 4.7631 - acc: 0.0197 - ETA: 117s - loss: 4.7626 - acc: 0.0201 - ETA: 116s - loss: 4.7622 - acc: 0.0202 - ETA: 115s - loss: 4.7628 - acc: 0.0204 - ETA: 114s - loss: 4.7627 - acc: 0.0203 - ETA: 113s - loss: 4.7632 - acc: 0.0202 - ETA: 112s - loss: 4.7629 - acc: 0.0201 - ETA: 111s - loss: 4.7629 - acc: 0.0202 - ETA: 110s - loss: 4.7628 - acc: 0.0204 - ETA: 109s - loss: 4.7626 - acc: 0.0203 - ETA: 108s - loss: 4.7626 - acc: 0.0204 - ETA: 107s - loss: 4.7624 - acc: 0.0205 - ETA: 106s - loss: 4.7630 - acc: 0.0204 - ETA: 105s - loss: 4.7628 - acc: 0.0206 - ETA: 104s - loss: 4.7624 - acc: 0.0207 - ETA: 103s - loss: 4.7618 - acc: 0.0206 - ETA: 102s - loss: 4.7622 - acc: 0.0205 - ETA: 101s - loss: 4.7611 - acc: 0.0206 - ETA: 100s - loss: 4.7603 - acc: 0.0208 - ETA: 99s - loss: 4.7600 - acc: 0.0207  - ETA: 98s - loss: 4.7597 - acc: 0.0206 - ETA: 97s - loss: 4.7582 - acc: 0.0207 - ETA: 96s - loss: 4.7592 - acc: 0.0206 - ETA: 95s - loss: 4.7590 - acc: 0.0205 - ETA: 93s - loss: 4.7581 - acc: 0.0207 - ETA: 92s - loss: 4.7581 - acc: 0.0210 - ETA: 91s - loss: 4.7574 - acc: 0.0211 - ETA: 90s - loss: 4.7568 - acc: 0.0212 - ETA: 89s - loss: 4.7571 - acc: 0.0213 - ETA: 88s - loss: 4.7576 - acc: 0.0213 - ETA: 87s - loss: 4.7574 - acc: 0.0214 - ETA: 86s - loss: 4.7573 - acc: 0.0215 - ETA: 85s - loss: 4.7567 - acc: 0.0214 - ETA: 84s - loss: 4.7568 - acc: 0.0215 - ETA: 83s - loss: 4.7575 - acc: 0.0216 - ETA: 82s - loss: 4.7574 - acc: 0.0215 - ETA: 81s - loss: 4.7573 - acc: 0.0215 - ETA: 80s - loss: 4.7571 - acc: 0.0214 - ETA: 79s - loss: 4.7569 - acc: 0.0213 - ETA: 78s - loss: 4.7569 - acc: 0.0214 - ETA: 77s - loss: 4.7569 - acc: 0.0213 - ETA: 76s - loss: 4.7568 - acc: 0.0212 - ETA: 75s - loss: 4.7565 - acc: 0.0212 - ETA: 74s - loss: 4.7563 - acc: 0.0213 - ETA: 73s - loss: 4.7566 - acc: 0.0212 - ETA: 72s - loss: 4.7567 - acc: 0.0213 - ETA: 71s - loss: 4.7567 - acc: 0.0214 - ETA: 70s - loss: 4.7575 - acc: 0.0213 - ETA: 69s - loss: 4.7581 - acc: 0.0212 - ETA: 68s - loss: 4.7577 - acc: 0.0212 - ETA: 67s - loss: 4.7572 - acc: 0.0211 - ETA: 65s - loss: 4.7573 - acc: 0.0210 - ETA: 64s - loss: 4.7573 - acc: 0.0209 - ETA: 63s - loss: 4.7567 - acc: 0.0210 - ETA: 62s - loss: 4.7565 - acc: 0.0210 - ETA: 61s - loss: 4.7551 - acc: 0.0209 - ETA: 60s - loss: 4.7551 - acc: 0.0210 - ETA: 59s - loss: 4.7543 - acc: 0.0209 - ETA: 58s - loss: 4.7546 - acc: 0.0208 - ETA: 57s - loss: 4.7550 - acc: 0.0208 - ETA: 56s - loss: 4.7551 - acc: 0.0207 - ETA: 55s - loss: 4.7548 - acc: 0.0206 - ETA: 54s - loss: 4.7551 - acc: 0.0207 - ETA: 53s - loss: 4.7552 - acc: 0.0208 - ETA: 52s - loss: 4.7550 - acc: 0.0207 - ETA: 51s - loss: 4.7550 - acc: 0.0207 - ETA: 50s - loss: 4.7550 - acc: 0.0206 - ETA: 49s - loss: 4.7549 - acc: 0.0205 - ETA: 48s - loss: 4.7550 - acc: 0.0205 - ETA: 47s - loss: 4.7555 - acc: 0.0204 - ETA: 46s - loss: 4.7560 - acc: 0.0203 - ETA: 45s - loss: 4.7556 - acc: 0.0202 - ETA: 44s - loss: 4.7554 - acc: 0.0203 - ETA: 43s - loss: 4.7566 - acc: 0.0203 - ETA: 42s - loss: 4.7567 - acc: 0.0202 - ETA: 41s - loss: 4.7561 - acc: 0.0203 - ETA: 40s - loss: 4.7562 - acc: 0.0202 - ETA: 39s - loss: 4.7559 - acc: 0.0203 - ETA: 38s - loss: 4.7553 - acc: 0.0203 - ETA: 37s - loss: 4.7556 - acc: 0.0202 - ETA: 36s - loss: 4.7552 - acc: 0.0203 - ETA: 35s - loss: 4.7550 - acc: 0.0202 - ETA: 34s - loss: 4.7555 - acc: 0.0202 - ETA: 33s - loss: 4.7550 - acc: 0.0201 - ETA: 32s - loss: 4.7550 - acc: 0.0202 - ETA: 31s - loss: 4.7558 - acc: 0.0201 - ETA: 30s - loss: 4.7555 - acc: 0.0204 - ETA: 29s - loss: 4.7552 - acc: 0.0205 - ETA: 28s - loss: 4.7554 - acc: 0.0204 - ETA: 27s - loss: 4.7557 - acc: 0.0204 - ETA: 26s - loss: 4.7561 - acc: 0.0203 - ETA: 25s - loss: 4.7557 - acc: 0.0204 - ETA: 24s - loss: 4.7557 - acc: 0.0205 - ETA: 23s - loss: 4.7555 - acc: 0.0204 - ETA: 22s - loss: 4.7549 - acc: 0.0204 - ETA: 21s - loss: 4.7552 - acc: 0.0203 - ETA: 20s - loss: 4.7555 - acc: 0.0205 - ETA: 19s - loss: 4.7556 - acc: 0.0205 - ETA: 18s - loss: 4.7556 - acc: 0.0204 - ETA: 17s - loss: 4.7555 - acc: 0.0203 - ETA: 16s - loss: 4.7561 - acc: 0.0203 - ETA: 15s - loss: 4.7565 - acc: 0.0202 - ETA: 14s - loss: 4.7565 - acc: 0.0202 - ETA: 13s - loss: 4.7565 - acc: 0.0202 - ETA: 12s - loss: 4.7561 - acc: 0.0205 - ETA: 11s - loss: 4.7561 - acc: 0.0204 - ETA: 10s - loss: 4.7559 - acc: 0.0204 - ETA: 9s - loss: 4.7561 - acc: 0.0203  - ETA: 8s - loss: 4.7564 - acc: 0.0202 - ETA: 7s - loss: 4.7565 - acc: 0.0203 - ETA: 6s - loss: 4.7564 - acc: 0.0203 - ETA: 5s - loss: 4.7567 - acc: 0.0202 - ETA: 4s - loss: 4.7572 - acc: 0.0205 - ETA: 3s - loss: 4.7573 - acc: 0.0205 - ETA: 2s - loss: 4.7570 - acc: 0.0209 - ETA: 1s - loss: 4.7567 - acc: 0.0212Epoch 00003: val_loss improved from 4.78935 to 4.76462, saving model to saved_models/weights.best.from_scratch.hdf5
    6680/6680 [==============================] - 352s - loss: 4.7566 - acc: 0.0211 - val_loss: 4.7646 - val_acc: 0.0156
    Epoch 5/5
    6660/6680 [============================>.] - ETA: 332s - loss: 4.9000 - acc: 0.0000e+00 - ETA: 329s - loss: 4.7450 - acc: 0.0000e+00 - ETA: 329s - loss: 4.7382 - acc: 0.0000e+00 - ETA: 327s - loss: 4.7561 - acc: 0.0000e+00 - ETA: 326s - loss: 4.8191 - acc: 0.0000e+00 - ETA: 327s - loss: 4.8148 - acc: 0.0000e+00 - ETA: 326s - loss: 4.7880 - acc: 0.0071     - ETA: 325s - loss: 4.7862 - acc: 0.0063 - ETA: 324s - loss: 4.7599 - acc: 0.0222 - ETA: 323s - loss: 4.7809 - acc: 0.0200 - ETA: 321s - loss: 4.7696 - acc: 0.0182 - ETA: 320s - loss: 4.7676 - acc: 0.0167 - ETA: 319s - loss: 4.7720 - acc: 0.0154 - ETA: 317s - loss: 4.7730 - acc: 0.0143 - ETA: 316s - loss: 4.7593 - acc: 0.0167 - ETA: 314s - loss: 4.7640 - acc: 0.0156 - ETA: 313s - loss: 4.7586 - acc: 0.0147 - ETA: 311s - loss: 4.7482 - acc: 0.0194 - ETA: 310s - loss: 4.7509 - acc: 0.0184 - ETA: 308s - loss: 4.7576 - acc: 0.0175 - ETA: 308s - loss: 4.7565 - acc: 0.0167 - ETA: 306s - loss: 4.7515 - acc: 0.0182 - ETA: 305s - loss: 4.7597 - acc: 0.0196 - ETA: 303s - loss: 4.7564 - acc: 0.0208 - ETA: 303s - loss: 4.7533 - acc: 0.0220 - ETA: 301s - loss: 4.7558 - acc: 0.0212 - ETA: 300s - loss: 4.7586 - acc: 0.0241 - ETA: 299s - loss: 4.7543 - acc: 0.0250 - ETA: 298s - loss: 4.7476 - acc: 0.0276 - ETA: 297s - loss: 4.7437 - acc: 0.0300 - ETA: 296s - loss: 4.7402 - acc: 0.0323 - ETA: 294s - loss: 4.7377 - acc: 0.0313 - ETA: 294s - loss: 4.7347 - acc: 0.0303 - ETA: 292s - loss: 4.7404 - acc: 0.0294 - ETA: 292s - loss: 4.7437 - acc: 0.0286 - ETA: 290s - loss: 4.7407 - acc: 0.0292 - ETA: 289s - loss: 4.7372 - acc: 0.0284 - ETA: 288s - loss: 4.7351 - acc: 0.0276 - ETA: 287s - loss: 4.7400 - acc: 0.0282 - ETA: 286s - loss: 4.7437 - acc: 0.0275 - ETA: 285s - loss: 4.7436 - acc: 0.0268 - ETA: 284s - loss: 4.7467 - acc: 0.0262 - ETA: 283s - loss: 4.7483 - acc: 0.0256 - ETA: 282s - loss: 4.7482 - acc: 0.0250 - ETA: 281s - loss: 4.7520 - acc: 0.0244 - ETA: 280s - loss: 4.7521 - acc: 0.0250 - ETA: 279s - loss: 4.7521 - acc: 0.0255 - ETA: 279s - loss: 4.7497 - acc: 0.0260 - ETA: 278s - loss: 4.7459 - acc: 0.0255 - ETA: 277s - loss: 4.7494 - acc: 0.0250 - ETA: 277s - loss: 4.7514 - acc: 0.0255 - ETA: 276s - loss: 4.7528 - acc: 0.0260 - ETA: 275s - loss: 4.7539 - acc: 0.0255 - ETA: 274s - loss: 4.7511 - acc: 0.0250 - ETA: 273s - loss: 4.7493 - acc: 0.0255 - ETA: 272s - loss: 4.7467 - acc: 0.0250 - ETA: 270s - loss: 4.7443 - acc: 0.0254 - ETA: 269s - loss: 4.7463 - acc: 0.0259 - ETA: 268s - loss: 4.7493 - acc: 0.0263 - ETA: 267s - loss: 4.7466 - acc: 0.0258 - ETA: 267s - loss: 4.7461 - acc: 0.0262 - ETA: 266s - loss: 4.7448 - acc: 0.0274 - ETA: 265s - loss: 4.7439 - acc: 0.0270 - ETA: 264s - loss: 4.7408 - acc: 0.0273 - ETA: 263s - loss: 4.7364 - acc: 0.0277 - ETA: 262s - loss: 4.7360 - acc: 0.0280 - ETA: 261s - loss: 4.7368 - acc: 0.0276 - ETA: 260s - loss: 4.7369 - acc: 0.0272 - ETA: 259s - loss: 4.7382 - acc: 0.0268 - ETA: 258s - loss: 4.7351 - acc: 0.0271 - ETA: 257s - loss: 4.7351 - acc: 0.0268 - ETA: 256s - loss: 4.7347 - acc: 0.0271 - ETA: 255s - loss: 4.7355 - acc: 0.0274 - ETA: 254s - loss: 4.7375 - acc: 0.0270 - ETA: 253s - loss: 4.7390 - acc: 0.0267 - ETA: 252s - loss: 4.7376 - acc: 0.0270 - ETA: 251s - loss: 4.7368 - acc: 0.0266 - ETA: 250s - loss: 4.7382 - acc: 0.0269 - ETA: 249s - loss: 4.7369 - acc: 0.0266 - ETA: 248s - loss: 4.7354 - acc: 0.0269 - ETA: 247s - loss: 4.7339 - acc: 0.0272 - ETA: 246s - loss: 4.7362 - acc: 0.0268 - ETA: 245s - loss: 4.7357 - acc: 0.0265 - ETA: 244s - loss: 4.7357 - acc: 0.0262 - ETA: 242s - loss: 4.7355 - acc: 0.0259 - ETA: 241s - loss: 4.7372 - acc: 0.0256 - ETA: 241s - loss: 4.7387 - acc: 0.0253 - ETA: 240s - loss: 4.7389 - acc: 0.0250 - ETA: 239s - loss: 4.7417 - acc: 0.0247 - ETA: 238s - loss: 4.7421 - acc: 0.0244 - ETA: 237s - loss: 4.7418 - acc: 0.0253 - ETA: 236s - loss: 4.7409 - acc: 0.0250 - ETA: 235s - loss: 4.7438 - acc: 0.0247 - ETA: 233s - loss: 4.7442 - acc: 0.0245 - ETA: 233s - loss: 4.7432 - acc: 0.0242 - ETA: 232s - loss: 4.7449 - acc: 0.0240 - ETA: 231s - loss: 4.7442 - acc: 0.0237 - ETA: 230s - loss: 4.7446 - acc: 0.0235 - ETA: 229s - loss: 4.7435 - acc: 0.0237 - ETA: 228s - loss: 4.7390 - acc: 0.0245 - ETA: 227s - loss: 4.7411 - acc: 0.0248 - ETA: 226s - loss: 4.7393 - acc: 0.0245 - ETA: 225s - loss: 4.7406 - acc: 0.0243 - ETA: 224s - loss: 4.7405 - acc: 0.0250 - ETA: 223s - loss: 4.7411 - acc: 0.0252 - ETA: 222s - loss: 4.7407 - acc: 0.0255 - ETA: 221s - loss: 4.7410 - acc: 0.0252 - ETA: 220s - loss: 4.7402 - acc: 0.0250 - ETA: 219s - loss: 4.7392 - acc: 0.0248 - ETA: 218s - loss: 4.7398 - acc: 0.0245 - ETA: 217s - loss: 4.7389 - acc: 0.0248 - ETA: 216s - loss: 4.7385 - acc: 0.0250 - ETA: 215s - loss: 4.7378 - acc: 0.0248 - ETA: 214s - loss: 4.7389 - acc: 0.0246 - ETA: 213s - loss: 4.7376 - acc: 0.0243 - ETA: 212s - loss: 4.7390 - acc: 0.0246 - ETA: 211s - loss: 4.7377 - acc: 0.0248 - ETA: 210s - loss: 4.7389 - acc: 0.0246 - ETA: 210s - loss: 4.7377 - acc: 0.0248 - ETA: 209s - loss: 4.7370 - acc: 0.0258 - ETA: 208s - loss: 4.7392 - acc: 0.0256 - ETA: 207s - loss: 4.7381 - acc: 0.0254 - ETA: 206s - loss: 4.7380 - acc: 0.0252 - ETA: 205s - loss: 4.7385 - acc: 0.0258 - ETA: 204s - loss: 4.7387 - acc: 0.0260 - ETA: 203s - loss: 4.7386 - acc: 0.0262 - ETA: 202s - loss: 4.7373 - acc: 0.0260 - ETA: 202s - loss: 4.7391 - acc: 0.0258 - ETA: 201s - loss: 4.7390 - acc: 0.0256 - ETA: 200s - loss: 4.7385 - acc: 0.0254 - ETA: 199s - loss: 4.7378 - acc: 0.0256 - ETA: 198s - loss: 4.7379 - acc: 0.0254 - ETA: 197s - loss: 4.7374 - acc: 0.0252 - ETA: 196s - loss: 4.7369 - acc: 0.0250 - ETA: 195s - loss: 4.7380 - acc: 0.0248 - ETA: 194s - loss: 4.7363 - acc: 0.0250 - ETA: 193s - loss: 4.7367 - acc: 0.0248 - ETA: 192s - loss: 4.7360 - acc: 0.0250 - ETA: 191s - loss: 4.7358 - acc: 0.0252 - ETA: 190s - loss: 4.7363 - acc: 0.0250 - ETA: 189s - loss: 4.7363 - acc: 0.0248 - ETA: 188s - loss: 4.7369 - acc: 0.0246 - ETA: 187s - loss: 4.7367 - acc: 0.0245 - ETA: 186s - loss: 4.7363 - acc: 0.0243 - ETA: 185s - loss: 4.7365 - acc: 0.0241 - ETA: 184s - loss: 4.7358 - acc: 0.0247 - ETA: 183s - loss: 4.7359 - acc: 0.0245 - ETA: 182s - loss: 4.7353 - acc: 0.0243 - ETA: 181s - loss: 4.7374 - acc: 0.0242 - ETA: 180s - loss: 4.7374 - acc: 0.0240 - ETA: 179s - loss: 4.7380 - acc: 0.0238 - ETA: 178s - loss: 4.7375 - acc: 0.0237 - ETA: 176s - loss: 4.7389 - acc: 0.0235 - ETA: 175s - loss: 4.7385 - acc: 0.0234 - ETA: 174s - loss: 4.7391 - acc: 0.0232 - ETA: 173s - loss: 4.7376 - acc: 0.0231 - ETA: 172s - loss: 4.7377 - acc: 0.0229 - ETA: 171s - loss: 4.7375 - acc: 0.0228 - ETA: 170s - loss: 4.7382 - acc: 0.0226 - ETA: 169s - loss: 4.7381 - acc: 0.0225 - ETA: 168s - loss: 4.7369 - acc: 0.0230 - ETA: 167s - loss: 4.7360 - acc: 0.0228 - ETA: 166s - loss: 4.7367 - acc: 0.0227 - ETA: 165s - loss: 4.7375 - acc: 0.0232 - ETA: 164s - loss: 4.7371 - acc: 0.0230 - ETA: 163s - loss: 4.7365 - acc: 0.0232 - ETA: 162s - loss: 4.7352 - acc: 0.0234 - ETA: 161s - loss: 4.7348 - acc: 0.0235 - ETA: 160s - loss: 4.7336 - acc: 0.0234 - ETA: 159s - loss: 4.7333 - acc: 0.0235 - ETA: 158s - loss: 4.7321 - acc: 0.0234 - ETA: 157s - loss: 4.7330 - acc: 0.0233 - ETA: 156s - loss: 4.7333 - acc: 0.0231 - ETA: 155s - loss: 4.7337 - acc: 0.0230 - ETA: 154s - loss: 4.7333 - acc: 0.0229 - ETA: 152s - loss: 4.7330 - acc: 0.0230 - ETA: 152s - loss: 4.7325 - acc: 0.0234 - ETA: 150s - loss: 4.7316 - acc: 0.0233 - ETA: 149s - loss: 4.7315 - acc: 0.0235 - ETA: 148s - loss: 4.7315 - acc: 0.0233 - ETA: 147s - loss: 4.7314 - acc: 0.0235 - ETA: 147s - loss: 4.7314 - acc: 0.0234 - ETA: 146s - loss: 4.7306 - acc: 0.0232 - ETA: 145s - loss: 4.7308 - acc: 0.0231 - ETA: 144s - loss: 4.7304 - acc: 0.0230 - ETA: 143s - loss: 4.7317 - acc: 0.0228 - ETA: 142s - loss: 4.7308 - acc: 0.0227 - ETA: 141s - loss: 4.7308 - acc: 0.0226 - ETA: 140s - loss: 4.7293 - acc: 0.0225 - ETA: 139s - loss: 4.7291 - acc: 0.0224 - ETA: 138s - loss: 4.7299 - acc: 0.0223 - ETA: 137s - loss: 4.7292 - acc: 0.0224 - ETA: 136s - loss: 4.7291 - acc: 0.0225 - ETA: 135s - loss: 4.7290 - acc: 0.0227 - ETA: 134s - loss: 4.7296 - acc: 0.0231 - ETA: 133s - loss: 4.7296 - acc: 0.0230 - ETA: 132s - loss: 4.7284 - acc: 0.0234 - ETA: 131s - loss: 4.7284 - acc: 0.0232 - ETA: 130s - loss: 4.7286 - acc: 0.0231 - ETA: 129s - loss: 4.7293 - acc: 0.0230 - ETA: 128s - loss: 4.7291 - acc: 0.0231 - ETA: 127s - loss: 4.7297 - acc: 0.0230 - ETA: 126s - loss: 4.7291 - acc: 0.0229 - ETA: 125s - loss: 4.7290 - acc: 0.0228 - ETA: 124s - loss: 4.7284 - acc: 0.0227 - ETA: 123s - loss: 4.7277 - acc: 0.0228 - ETA: 122s - loss: 4.7284 - acc: 0.0229 - ETA: 121s - loss: 4.7287 - acc: 0.0231 - ETA: 120s - loss: 4.7286 - acc: 0.0230 - ETA: 119s - loss: 4.7290 - acc: 0.0229 - ETA: 118s - loss: 4.7289 - acc: 0.0227 - ETA: 117s - loss: 4.7299 - acc: 0.0226 - ETA: 116s - loss: 4.7296 - acc: 0.0225 - ETA: 115s - loss: 4.7297 - acc: 0.0224 - ETA: 114s - loss: 4.7303 - acc: 0.0223 - ETA: 113s - loss: 4.7309 - acc: 0.0222 - ETA: 112s - loss: 4.7305 - acc: 0.0221 - ETA: 111s - loss: 4.7308 - acc: 0.0220 - ETA: 110s - loss: 4.7297 - acc: 0.0221 - ETA: 109s - loss: 4.7305 - acc: 0.0220 - ETA: 108s - loss: 4.7307 - acc: 0.0222 - ETA: 107s - loss: 4.7306 - acc: 0.0223 - ETA: 106s - loss: 4.7304 - acc: 0.0222 - ETA: 105s - loss: 4.7306 - acc: 0.0221 - ETA: 104s - loss: 4.7306 - acc: 0.0220 - ETA: 103s - loss: 4.7303 - acc: 0.0219 - ETA: 102s - loss: 4.7305 - acc: 0.0218 - ETA: 101s - loss: 4.7308 - acc: 0.0217 - ETA: 100s - loss: 4.7309 - acc: 0.0216 - ETA: 99s - loss: 4.7320 - acc: 0.0215  - ETA: 98s - loss: 4.7319 - acc: 0.0216 - ETA: 97s - loss: 4.7327 - acc: 0.0218 - ETA: 96s - loss: 4.7325 - acc: 0.0217 - ETA: 95s - loss: 4.7320 - acc: 0.0218 - ETA: 94s - loss: 4.7321 - acc: 0.0219 - ETA: 93s - loss: 4.7316 - acc: 0.0218 - ETA: 92s - loss: 4.7324 - acc: 0.0219 - ETA: 92s - loss: 4.7320 - acc: 0.0218 - ETA: 91s - loss: 4.7315 - acc: 0.0218 - ETA: 90s - loss: 4.7321 - acc: 0.0219 - ETA: 89s - loss: 4.7315 - acc: 0.0218 - ETA: 88s - loss: 4.7324 - acc: 0.0217 - ETA: 87s - loss: 4.7315 - acc: 0.0218 - ETA: 86s - loss: 4.7317 - acc: 0.0217 - ETA: 85s - loss: 4.7324 - acc: 0.0216 - ETA: 84s - loss: 4.7322 - acc: 0.0217 - ETA: 83s - loss: 4.7331 - acc: 0.0217 - ETA: 82s - loss: 4.7332 - acc: 0.0216 - ETA: 81s - loss: 4.7334 - acc: 0.0215 - ETA: 80s - loss: 4.7338 - acc: 0.0214 - ETA: 79s - loss: 4.7353 - acc: 0.0213 - ETA: 78s - loss: 4.7345 - acc: 0.0216 - ETA: 77s - loss: 4.7340 - acc: 0.0217 - ETA: 76s - loss: 4.7344 - acc: 0.0217 - ETA: 75s - loss: 4.7345 - acc: 0.0216 - ETA: 74s - loss: 4.7342 - acc: 0.0217 - ETA: 73s - loss: 4.7339 - acc: 0.0216 - ETA: 73s - loss: 4.7339 - acc: 0.0215 - ETA: 72s - loss: 4.7334 - acc: 0.0216 - ETA: 71s - loss: 4.7322 - acc: 0.0215 - ETA: 70s - loss: 4.7319 - acc: 0.0215 - ETA: 69s - loss: 4.7316 - acc: 0.0214 - ETA: 68s - loss: 4.7313 - acc: 0.0213 - ETA: 67s - loss: 4.7308 - acc: 0.0212 - ETA: 66s - loss: 4.7304 - acc: 0.0211 - ETA: 65s - loss: 4.7306 - acc: 0.0211 - ETA: 64s - loss: 4.7319 - acc: 0.0210 - ETA: 64s - loss: 4.7323 - acc: 0.0209 - ETA: 63s - loss: 4.7321 - acc: 0.0208 - ETA: 62s - loss: 4.7319 - acc: 0.0211 - ETA: 61s - loss: 4.7325 - acc: 0.0210 - ETA: 60s - loss: 4.7324 - acc: 0.0210 - ETA: 59s - loss: 4.7323 - acc: 0.0209 - ETA: 58s - loss: 4.7321 - acc: 0.0210 - ETA: 57s - loss: 4.7315 - acc: 0.0209 - ETA: 56s - loss: 4.7314 - acc: 0.0210 - ETA: 55s - loss: 4.7312 - acc: 0.0209 - ETA: 54s - loss: 4.7310 - acc: 0.0210 - ETA: 53s - loss: 4.7306 - acc: 0.0211 - ETA: 52s - loss: 4.7302 - acc: 0.0213 - ETA: 51s - loss: 4.7318 - acc: 0.0212 - ETA: 50s - loss: 4.7316 - acc: 0.0216 - ETA: 50s - loss: 4.7315 - acc: 0.0217 - ETA: 49s - loss: 4.7309 - acc: 0.0220 - ETA: 48s - loss: 4.7311 - acc: 0.0219 - ETA: 47s - loss: 4.7308 - acc: 0.0220 - ETA: 46s - loss: 4.7306 - acc: 0.0220 - ETA: 45s - loss: 4.7302 - acc: 0.0220 - ETA: 44s - loss: 4.7298 - acc: 0.0220 - ETA: 43s - loss: 4.7298 - acc: 0.0221 - ETA: 42s - loss: 4.7296 - acc: 0.0220 - ETA: 41s - loss: 4.7294 - acc: 0.0219 - ETA: 40s - loss: 4.7295 - acc: 0.0218 - ETA: 39s - loss: 4.7293 - acc: 0.0221 - ETA: 38s - loss: 4.7291 - acc: 0.0222 - ETA: 37s - loss: 4.7287 - acc: 0.0223 - ETA: 36s - loss: 4.7294 - acc: 0.0222 - ETA: 35s - loss: 4.7285 - acc: 0.0223 - ETA: 34s - loss: 4.7287 - acc: 0.0224 - ETA: 33s - loss: 4.7280 - acc: 0.0223 - ETA: 32s - loss: 4.7282 - acc: 0.0226 - ETA: 31s - loss: 4.7279 - acc: 0.0225 - ETA: 30s - loss: 4.7282 - acc: 0.0224 - ETA: 29s - loss: 4.7281 - acc: 0.0224 - ETA: 28s - loss: 4.7283 - acc: 0.0223 - ETA: 27s - loss: 4.7276 - acc: 0.0225 - ETA: 26s - loss: 4.7275 - acc: 0.0225 - ETA: 25s - loss: 4.7279 - acc: 0.0224 - ETA: 24s - loss: 4.7272 - acc: 0.0223 - ETA: 23s - loss: 4.7273 - acc: 0.0224 - ETA: 22s - loss: 4.7268 - acc: 0.0223 - ETA: 21s - loss: 4.7270 - acc: 0.0224 - ETA: 20s - loss: 4.7263 - acc: 0.0225 - ETA: 19s - loss: 4.7265 - acc: 0.0226 - ETA: 18s - loss: 4.7262 - acc: 0.0229 - ETA: 17s - loss: 4.7257 - acc: 0.0228 - ETA: 16s - loss: 4.7255 - acc: 0.0229 - ETA: 15s - loss: 4.7259 - acc: 0.0228 - ETA: 14s - loss: 4.7255 - acc: 0.0227 - ETA: 13s - loss: 4.7252 - acc: 0.0227 - ETA: 12s - loss: 4.7260 - acc: 0.0226 - ETA: 11s - loss: 4.7260 - acc: 0.0228 - ETA: 11s - loss: 4.7262 - acc: 0.0229 - ETA: 10s - loss: 4.7263 - acc: 0.0230 - ETA: 9s - loss: 4.7262 - acc: 0.0229  - ETA: 8s - loss: 4.7256 - acc: 0.0229 - ETA: 7s - loss: 4.7251 - acc: 0.0228 - ETA: 6s - loss: 4.7254 - acc: 0.0227 - ETA: 5s - loss: 4.7255 - acc: 0.0226 - ETA: 4s - loss: 4.7255 - acc: 0.0227 - ETA: 3s - loss: 4.7256 - acc: 0.0227 - ETA: 2s - loss: 4.7262 - acc: 0.0226 - ETA: 1s - loss: 4.7262 - acc: 0.0225Epoch 00004: val_loss improved from 4.76462 to 4.74354, saving model to saved_models/weights.best.from_scratch.hdf5
    6680/6680 [==============================] - 353s - loss: 4.7259 - acc: 0.0226 - val_loss: 4.7435 - val_acc: 0.0251
    




    <keras.callbacks.History at 0x1b904506668>



### Load the Model with the Best Validation Loss


```python
model.load_weights('saved_models/weights.best.from_scratch.hdf5')
```

### Test the Model

Try out your model on the test dataset of dog images.  Ensure that your test accuracy is greater than 1%.


```python
# get index of predicted dog breed for each image in test set
dog_breed_predictions = [np.argmax(model.predict(np.expand_dims(tensor, axis=0))) for tensor in test_tensors]

# report test accuracy
test_accuracy = 100*np.sum(np.array(dog_breed_predictions)==np.argmax(test_targets, axis=1))/len(dog_breed_predictions)
print('Test accuracy: %.4f%%' % test_accuracy)
```

    Test accuracy: 2.6316%
    

---
<a id='step4'></a>
## Step 4: Use a CNN to Classify Dog Breeds

To reduce training time without sacrificing accuracy, we show you how to train a CNN using transfer learning.  In the following step, you will get a chance to use transfer learning to train your own CNN.

### Obtain Bottleneck Features


```python
bottleneck_features = np.load('bottleneck_features/DogVGG16Data.npz')
train_VGG16 = bottleneck_features['train']
valid_VGG16 = bottleneck_features['valid']
test_VGG16 = bottleneck_features['test']
```

### Model Architecture

The model uses the the pre-trained VGG-16 model as a fixed feature extractor, where the last convolutional output of VGG-16 is fed as input to our model.  We only add a global average pooling layer and a fully connected layer, where the latter contains one node for each dog category and is equipped with a softmax.


```python
VGG16_model = Sequential()
VGG16_model.add(GlobalAveragePooling2D(input_shape=train_VGG16.shape[1:]))
VGG16_model.add(Dense(133, activation='softmax'))

VGG16_model.summary()
```

    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    global_average_pooling2d_2 ( (None, 512)               0         
    _________________________________________________________________
    dense_2 (Dense)              (None, 133)               68229     
    =================================================================
    Total params: 68,229.0
    Trainable params: 68,229.0
    Non-trainable params: 0.0
    _________________________________________________________________
    

### Compile the Model


```python
VGG16_model.compile(loss='categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])
```

### Train the Model


```python
checkpointer = ModelCheckpoint(filepath='saved_models/weights.best.VGG16.hdf5', 
                               verbose=1, save_best_only=True)

VGG16_model.fit(train_VGG16, train_targets, 
          validation_data=(valid_VGG16, valid_targets),
          epochs=20, batch_size=20, callbacks=[checkpointer], verbose=1)
```

### Load the Model with the Best Validation Loss


```python
VGG16_model.load_weights('saved_models/weights.best.VGG16.hdf5')
```

### Test the Model

Now, we can use the CNN to test how well it identifies breed within our test dataset of dog images.  We print the test accuracy below.


```python
# get index of predicted dog breed for each image in test set
VGG16_predictions = [np.argmax(VGG16_model.predict(np.expand_dims(feature, axis=0))) for feature in test_VGG16]

# report test accuracy
test_accuracy = 100*np.sum(np.array(VGG16_predictions)==np.argmax(test_targets, axis=1))/len(VGG16_predictions)
print('Test accuracy: %.4f%%' % test_accuracy)
```

    Test accuracy: 40.4306%
    

### Predict Dog Breed with the Model


```python
from extract_bottleneck_features import *

def VGG16_predict_breed(img_path):
    # extract bottleneck features
    bottleneck_feature = extract_VGG16(path_to_tensor(img_path))
    # obtain predicted vector
    predicted_vector = VGG16_model.predict(bottleneck_feature)
    # return dog breed that is predicted by the model
    return dog_names[np.argmax(predicted_vector)]
```

---
<a id='step5'></a>
## Step 5: Create a CNN to Classify Dog Breeds (using Transfer Learning)

You will now use transfer learning to create a CNN that can identify dog breed from images.  Your CNN must attain at least 60% accuracy on the test set.

In Step 4, we used transfer learning to create a CNN using VGG-16 bottleneck features.  In this section, you must use the bottleneck features from a different pre-trained model.  To make things easier for you, we have pre-computed the features for all of the networks that are currently available in Keras:
- [VGG-19](https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogVGG19Data.npz) bottleneck features
- [ResNet-50](https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogResnet50Data.npz) bottleneck features
- [Inception](https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogInceptionV3Data.npz) bottleneck features
- [Xception](https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogXceptionData.npz) bottleneck features

The files are encoded as such:

    Dog{network}Data.npz
    
where `{network}`, in the above filename, can be one of `VGG19`, `Resnet50`, `InceptionV3`, or `Xception`.  Pick one of the above architectures, download the corresponding bottleneck features, and store the downloaded file in the `bottleneck_features/` folder in the repository.

### (IMPLEMENTATION) Obtain Bottleneck Features

In the code block below, extract the bottleneck features corresponding to the train, test, and validation sets by running the following:

    bottleneck_features = np.load('bottleneck_features/Dog{network}Data.npz')
    train_{network} = bottleneck_features['train']
    valid_{network} = bottleneck_features['valid']
    test_{network} = bottleneck_features['test']


```python
### TODO: Obtain bottleneck features from another pre-trained CNN.
bottleneck_features_resnet = np.load('bottleneck_features/DogResnet50Data.npz')
train_resnet = bottleneck_features_resnet['train']
valid_resnet = bottleneck_features_resnet['valid']
test_resnet = bottleneck_features_resnet['test']
```

### (IMPLEMENTATION) Model Architecture

Create a CNN to classify dog breed.  At the end of your code cell block, summarize the layers of your model by executing the line:
    
        <your model's name>.summary()
   
__Question 5:__ Outline the steps you took to get to your final CNN architecture and your reasoning at each step.  Describe why you think the architecture is suitable for the current problem.

__Answer:__ My final CNN architecture leverages the ResNet 50 model. I then take the bottleneck features of images passed through this network and then pass them through a global average pooling and then a dense layer. This structure works well because my dataset is small and similar to the data the ResNet-50 data was trained on. As such I can leverage this model to output the key features. The global average pooling layer then helps reduce the dimensions so that my model trains faster and avoids overfitting. Last I have a dense fully connected layer wiht a softmax activation layer to make the predictions of the dog breed.





```python
### TODO: Define your architecture.
resnet_model = Sequential()
resnet_model.add(GlobalAveragePooling2D(input_shape=train_resnet.shape[1:]))
resnet_model.add(Dense(133, activation='softmax'))

resnet_model.summary()
```

    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    global_average_pooling2d_3 ( (None, 2048)              0         
    _________________________________________________________________
    dense_3 (Dense)              (None, 133)               272517    
    =================================================================
    Total params: 272,517.0
    Trainable params: 272,517.0
    Non-trainable params: 0.0
    _________________________________________________________________
    

### (IMPLEMENTATION) Compile the Model


```python
### TODO: Compile the model.
resnet_model.compile(loss='categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])
```

### (IMPLEMENTATION) Train the Model

Train your model in the code cell below.  Use model checkpointing to save the model that attains the best validation loss.  

You are welcome to [augment the training data](https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html), but this is not a requirement. 


```python
### TODO: Train the model.
from keras.callbacks import ModelCheckpoint

checkpointer = ModelCheckpoint(filepath='saved_models/weights.best.resnet.hdf5', 
                               verbose=1, save_best_only=True)

resnet_model.fit(train_resnet, train_targets, 
          validation_data=(valid_resnet, valid_targets),
          epochs=20, batch_size=20, callbacks=[checkpointer], verbose=1)
```

    Train on 6680 samples, validate on 835 samples
    Epoch 1/20
    6660/6680 [============================>.] - ETA: 0s - loss: 1.6113 - acc: 0.6060 Epoch 00000: val_loss improved from inf to 0.83441, saving model to saved_models/weights.best.resnet.hdf5
    6680/6680 [==============================] - 4s - loss: 1.6092 - acc: 0.6063 - val_loss: 0.8344 - val_acc: 0.7629
    Epoch 2/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.4360 - acc: 0.8633Epoch 00001: val_loss improved from 0.83441 to 0.66902, saving model to saved_models/weights.best.resnet.hdf5
    6680/6680 [==============================] - 3s - loss: 0.4342 - acc: 0.8639 - val_loss: 0.6690 - val_acc: 0.7880
    Epoch 3/20
    6580/6680 [============================>.] - ETA: 0s - loss: 0.2628 - acc: 0.9196Epoch 00002: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.2649 - acc: 0.9187 - val_loss: 0.7253 - val_acc: 0.7749
    Epoch 4/20
    6600/6680 [============================>.] - ETA: 0s - loss: 0.1736 - acc: 0.9456Epoch 00003: val_loss improved from 0.66902 to 0.66875, saving model to saved_models/weights.best.resnet.hdf5
    6680/6680 [==============================] - 3s - loss: 0.1737 - acc: 0.9454 - val_loss: 0.6687 - val_acc: 0.7964
    Epoch 5/20
    6580/6680 [============================>.] - ETA: 0s - loss: 0.1235 - acc: 0.9632Epoch 00004: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.1224 - acc: 0.9636 - val_loss: 0.6803 - val_acc: 0.8012
    Epoch 6/20
    6660/6680 [============================>.] - ETA: 0s - loss: 0.0874 - acc: 0.9748Epoch 00005: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.0874 - acc: 0.9747 - val_loss: 0.6852 - val_acc: 0.8096
    Epoch 7/20
    6660/6680 [============================>.] - ETA: 0s - loss: 0.0639 - acc: 0.9808Epoch 00006: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.0643 - acc: 0.9805 - val_loss: 0.7082 - val_acc: 0.8120
    Epoch 8/20
    6640/6680 [============================>.] - ETA: 0s - loss: 0.0476 - acc: 0.9864Epoch 00007: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.0477 - acc: 0.9864 - val_loss: 0.6800 - val_acc: 0.8263
    Epoch 9/20
    6640/6680 [============================>.] - ETA: 0s - loss: 0.0383 - acc: 0.9884Epoch 00008: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.0381 - acc: 0.9885 - val_loss: 0.7457 - val_acc: 0.8204
    Epoch 10/20
    6660/6680 [============================>.] - ETA: 0s - loss: 0.0280 - acc: 0.9926Epoch 00009: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0280 - acc: 0.9925 - val_loss: 0.7070 - val_acc: 0.8287
    Epoch 11/20
    6640/6680 [============================>.] - ETA: 0s - loss: 0.0216 - acc: 0.9935Epoch 00010: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0217 - acc: 0.9934 - val_loss: 0.8103 - val_acc: 0.8120
    Epoch 12/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.0175 - acc: 0.9955    Epoch 00011: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0174 - acc: 0.9955 - val_loss: 0.7767 - val_acc: 0.8180
    Epoch 13/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.0149 - acc: 0.9970Epoch 00012: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0150 - acc: 0.9969 - val_loss: 0.8105 - val_acc: 0.8180
    Epoch 14/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.0109 - acc: 0.9977Epoch 00013: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0109 - acc: 0.9978 - val_loss: 0.8170 - val_acc: 0.8240
    Epoch 15/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.0089 - acc: 0.9974    Epoch 00014: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.0089 - acc: 0.9975 - val_loss: 0.8719 - val_acc: 0.8204
    Epoch 16/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.0077 - acc: 0.9983    Epoch 00015: val_loss did not improve
    6680/6680 [==============================] - 4s - loss: 0.0076 - acc: 0.9984 - val_loss: 0.9258 - val_acc: 0.8132
    Epoch 17/20
    6660/6680 [============================>.] - ETA: 0s - loss: 0.0073 - acc: 0.9983    Epoch 00016: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0073 - acc: 0.9984 - val_loss: 0.8522 - val_acc: 0.8359
    Epoch 18/20
    6580/6680 [============================>.] - ETA: 0s - loss: 0.0063 - acc: 0.9983    Epoch 00017: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0062 - acc: 0.9984 - val_loss: 0.9175 - val_acc: 0.8168
    Epoch 19/20
    6640/6680 [============================>.] - ETA: 0s - loss: 0.0063 - acc: 0.9988    Epoch 00018: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0063 - acc: 0.9988 - val_loss: 0.8932 - val_acc: 0.8240
    Epoch 20/20
    6620/6680 [============================>.] - ETA: 0s - loss: 0.0058 - acc: 0.9985    Epoch 00019: val_loss did not improve
    6680/6680 [==============================] - 3s - loss: 0.0057 - acc: 0.9985 - val_loss: 0.9294 - val_acc: 0.8240
    




    <keras.callbacks.History at 0x1ff0b9f86a0>



### (IMPLEMENTATION) Load the Model with the Best Validation Loss


```python
### TODO: Load the model weights with the best validation loss.
resnet_model.load_weights('saved_models/weights.best.resnet.hdf5')
```

### (IMPLEMENTATION) Test the Model

Try out your model on the test dataset of dog images. Ensure that your test accuracy is greater than 60%.


```python
### TODO: Calculate classification accuracy on the test dataset.

# get index of predicted dog breed for each image in test set
resnet_predictions = [np.argmax(resnet_model.predict(np.expand_dims(feature, axis=0))) for feature in test_resnet]

# report test accuracy
test_accuracy = 100*np.sum(np.array(resnet_predictions)==np.argmax(test_targets, axis=1))/len(resnet_predictions)
print('Test accuracy: %.4f%%' % test_accuracy)
```

    Test accuracy: 80.1435%
    

### (IMPLEMENTATION) Predict Dog Breed with the Model

Write a function that takes an image path as input and returns the dog breed (`Affenpinscher`, `Afghan_hound`, etc) that is predicted by your model.  

Similar to the analogous function in Step 5, your function should have three steps:
1. Extract the bottleneck features corresponding to the chosen CNN model.
2. Supply the bottleneck features as input to the model to return the predicted vector.  Note that the argmax of this prediction vector gives the index of the predicted dog breed.
3. Use the `dog_names` array defined in Step 0 of this notebook to return the corresponding breed.

The functions to extract the bottleneck features can be found in `extract_bottleneck_features.py`, and they have been imported in an earlier code cell.  To obtain the bottleneck features corresponding to your chosen CNN architecture, you need to use the function

    extract_{network}
    
where `{network}`, in the above filename, should be one of `VGG19`, `Resnet50`, `InceptionV3`, or `Xception`.


```python
### TODO: Write a function that takes a path to an image as input
### and returns the dog breed that is predicted by the model.

from extract_bottleneck_features import *

def resnet_predict_breed(img_path):
    # extract bottleneck features
    bottleneck_feature = extract_Resnet50(path_to_tensor(img_path))
    # obtain predicted vector
    predicted_vector = resnet_model.predict(bottleneck_feature)
    # return dog breed that is predicted by the model
    return dog_names[np.argmax(predicted_vector)]
```

---
<a id='step6'></a>
## Step 6: Write your Algorithm

Write an algorithm that accepts a file path to an image and first determines whether the image contains a human, dog, or neither.  Then,
- if a __dog__ is detected in the image, return the predicted breed.
- if a __human__ is detected in the image, return the resembling dog breed.
- if __neither__ is detected in the image, provide output that indicates an error.

You are welcome to write your own functions for detecting humans and dogs in images, but feel free to use the `face_detector` and `dog_detector` functions developed above.  You are __required__ to use your CNN from Step 5 to predict dog breed.  

Some sample output for our algorithm is provided below, but feel free to design your own user experience!

![Sample Human Output](images/sample_human_output.png)


### (IMPLEMENTATION) Write your Algorithm


```python
### TODO: Write your algorithm.
### Feel free to use as many code cells as needed.
def my_algorithm(img_path):
    print('analyzing...')
    plt.imshow(image.load_img(img_path, target_size=(224, 224)))
    plt.show()
    if dog_detector(img_path) == True:
        print("this looks like a dog . . .")
        print("is it a ",resnet_predict_breed(img_path),"?") 
    elif face_detector(img_path) == True:
        print("seems human to me. . .")
        print("but maybe you are a ",resnet_predict_breed(img_path)," at heart")
    else:
        print("error: neither dog nor human detected")
```

---
<a id='step7'></a>
## Step 7: Test Your Algorithm

In this section, you will take your new algorithm for a spin!  What kind of dog does the algorithm think that __you__ look like?  If you have a dog, does it predict your dog's breed accurately?  If you have a cat, does it mistakenly think that your cat is a dog?

### (IMPLEMENTATION) Test Your Algorithm on Sample Images!

Test your algorithm at least six images on your computer.  Feel free to use any images you like.  Use at least two human and two dog images.  

__Question 6:__ Is the output better than you expected :) ?  Or worse :( ?  Provide at least three possible points of improvement for your algorithm.

__Answer:__ The model is better than I expected. I was impress that it was able to reach 80% accuracy, futhermore I find that the predictions it makes on likeness of breeds to human photos make sense. Three possible points of improvement to the model would be: 1. training the model on a larger set of training data 2. having multiple models to detect if the photo is a dog or human to ensure the right thing is detected. 3 refining the weights of the resnet50 model with additional training on dog photos.


```python
## TODO: Execute your algorithm from Step 6 on
## at least 6 images on your computer.
## Feel free to use as many code cells as needed.

my_algorithm('dogImages/test/001.Affenpinscher/Affenpinscher_00023.jpg')
```

    analyzing...
    


![png](output_65_1.png)


    this looks like a dog . . .
    is it a  Affenpinscher ?
    


```python
my_algorithm('images/headshot.JPG')
```

    analyzing...
    


![png](output_66_1.png)


    this looks like a human. . .
    but maybe you are a  Maltese  at heart
    


```python
my_algorithm('images/sofia.jpg')
```

    analyzing...
    


![png](output_67_1.png)


    seems human to me. . .
    but maybe you are a  Afghan_hound  at heart
    


```python
my_algorithm('images/marlon.jpg')
```

    analyzing...
    


![png](output_68_1.png)


    seems human to me. . .
    but maybe you are a  Cane_corso  at heart
    


```python
my_algorithm('images/sarah.jpg')
```

    analyzing...
    


![png](output_69_1.png)


    seems human to me. . .
    but maybe you are a  English_toy_spaniel  at heart
    


```python
my_algorithm('images/onur.jpg')
```

    analyzing...
    


![png](output_70_1.png)


    seems human to me. . .
    but maybe you are a  English_springer_spaniel  at heart
    


```python
my_algorithm('dogImages/test/016.Beagle/Beagle_01141.jpg')
```

    analyzing...
    


![png](output_71_1.png)


    this looks like a dog . . .
    is it a  Beagle ?
    
